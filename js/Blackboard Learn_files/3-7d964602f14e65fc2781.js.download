(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"0e3W":function(t,i,n){var s=n("4BeY"),e=n("IaFt"),a=new s({id:"icon-small-feedback",use:"icon-small-feedback-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-feedback"><path d="M1 1h14v12h-4l-3 2-3-2H1V1zM4 4h8M4 7h8M4 10h4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});e.add(a);t.exports=a},"367g":function(t,i,n){},BBHJ:function(t,i){t.exports='<div class="bb-statistics">\n  <ul class="statistics-list total-items-{{::statistics.total}} small-per-row-{{::statistics.smallPerRow}} large-per-row-{{::statistics.largePerRow}}">\n    <li ng-repeat="item in statistics.config">\n      <div class="statistics-item-container" ng-class="{\'no-default-padding\': item.noDefaultPadding, \'full-height\': !item.complexScope}">\n        <div class="stat-title" ng-attr-title="{{ item.hover ? item.hover : undefined }}" bb-translate>{{::item.title}}</div>\n        <div ng-if="::!item.complexScope" bb-simple-statistic item="::item"></div>\n        <div ng-if="::item.complexScope" bb-complex-statistic item="::item"></div>\n      </div>\n    </li>\n  </ul>\n</div>'},De5J:function(t,i,n){},ELoy:function(t,i,n){"use strict";n.d(i,"a",function(){return o});n("px9Z"),n("De5J"),n("pWIa");var s=n("IbG+"),e=n("lEL+"),a=n("oI8f"),o="ultra.directives.telemetry.panel.header",c=function(){function t(i,n){var s=this;this.scope=i,this.timeout=n,this.showSpinner=!1,this.spinnerTimeout=this.timeout(function(){s.showSpinner=!0},this.scope,t.WAIT_TIME_TO_SHOW_SPINNER),this.scope.$watch("::panelDataLoaded()",function(t){t&&s.dataLoaded()})}return t.prototype.dataLoaded=function(){this.timeout.cancel(this.spinnerTimeout),this.showSpinner=!1},t.$inject=["scope",e.b],t.WAIT_TIME_TO_SHOW_SPINNER=1e3,t}(),r=function(){function t(t){var i=this;this.$injector=t,this.restrict="E",this.template=a,this.transclude=!0,this.scope={course:"&",panelDataLoaded:"&",titleKey:"@?",title:"@?",buttonOneIcon:"@",buttonOneCallback:"&",buttonOneAriaLabel:"@",buttonOneTitle:"@",buttonTwoIcon:"@",buttonTwoCallback:"&",buttonTwoAriaLabel:"@",buttonTwoTitle:"@"},this.link=function(t){t.telemetryPanelHeader=i.$injector.instantiate(c,{scope:t})}}return t.$inject=["$injector"],t}();s.module(o,[]).directive("bbTelemetryPanelHeader",["$injector",function(t){return t.instantiate(r)}])},Mm3V:function(t,i){t.exports='<div class="simple-statistic-contents" ng-class="::item().cssClass">\n  <div bb-tooltip enhanced-tooltip="true" data-tooltip-on-overflow-only="true" title="{{ ::item().data }}">\n    <div class="stat-data"\n         ng-attr-aria-label="{{ item().aria ? item().aria : undefined }}"\n         data-ng-bind-html="::item().trusted"\n         data-ellipsis></div>\n  </div>\n  <div ng-if="::item().subtext" class="stat-sub-text" bb-translate>{{ ::item().subtext }}</div>\n  <div ng-if="::!item().subtext && item().reserveSubtextSpace" class="stat-sub-text" aria-hidden="true">&nbsp;</div>\n</div>'},RG3S:function(t,i,n){var s=n("4BeY"),e=n("IaFt"),a=new s({id:"icon-small-replies",use:"icon-small-replies-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-replies"><path d="M1 5h14v10H1v-4" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" /><path d="M3 3L1 5l2 2" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});e.add(a);t.exports=a},S3dm:function(t,i){t.exports='<div class="complex-statistic-contents"></div>'},Tn43:function(t,i,n){"use strict";(function(t){n.d(i,"a",function(){return P});n("367g"),n("0e3W"),n("RG3S"),n("HFr7"),n("jcgw"),n("1qB0");var s=n("IbG+"),e=n("LvDl"),a=n("en1n"),o=n("0JpG"),c=n("suMx"),r=n("jciN"),l=n("JNtI"),p=n("+e2k"),d=n("+g6d"),u=n("TnpK"),m=n("g7Mf"),h=n("r6lH"),b=n("ELoy"),g=n("pjml"),v=n("f4B+"),f=n("yC9S"),y=n("qvzR"),P="ultra.components.directives.discussion",w=function(){function i(t,i,n,s,a,o,c,r,l,p){var d=this;this.$window=t,this.$sce=i,this.scope=n,this.element=s,this.$stateParams=a,this.bbLocalize=o,this.telemetry=c,this.discussion=r,this.ultraState=l,this.courseModel=p,n.isLoaded=!1,n.courseId=n.content().courseId,n.contentId=n.content().id,n.isGroupDiscussion=n.content().isGroupContent,this.createDfiReport(n.courseId,n.contentId),f.b.OnWindow("resize",e.debounce(function(){(d.scope.displayNonParticipants||d.scope.displayNonParticipantGroup)&&(d.updateNonParticipantView(),d.scope.$apply())},150),n)}return i.prototype.createDfiReport=function(t,i,n){var s=this;(n?this.telemetry.loadDiscussionActivityData(t,i,n):this.telemetry.loadDiscussionActivityData(t,i)).then(function(t){s.scope.discussionData=t,s.scope.header=s.bbLocalize.translateSync({locale:s.bbLocalize.getLocale(s.scope),key:"components.directives.discussion.insights.header",params:{title:s.scope.content().title},noEscape:!0,noWrap:!0}),s.scope.course=s.courseModel.$find(s.scope.courseId),s.scope.isSingleGroup=!!n,s.scope.groups=s.scope.discussionData.groups,s.scope.isGradable=!!s.scope.discussionData.gradeColumnId,s.scope.gradingColumn=s.scope.discussionData.gradeColumnId,s.scope.viewedOnlyCount=s.scope.discussionData.viewedOnlyCount,s.scope.avgCommentsPerStudent=s.scope.discussionData.avgCommentsPerStudent?s.scope.discussionData.avgCommentsPerStudent:0,s.scope.avgWordCountPerComment=s.scope.discussionData.avgWordCountPerComment?s.scope.discussionData.avgWordCountPerComment:0,s.scope.avgGradeOfDiscussion=s.scope.discussionData.avgGrade?s.scope.discussionData.avgGrade/100:0,s.scope.numberOfCommentsToDisplay=1,s.scope.topComments=[],s.scope.displayTopComments=!1,s.scope.topParticipants=[],s.scope.displayTopParticipants=!1,s.scope.nonParticipants=[],s.scope.showNonparticipant=[],s.scope.showLargeNonparticipantPanel=!0,s.scope.minHeightForTopBoxes="auto",s.scope.nonParticipants=s.getNonParticipants(),s.scope.displayNonParticipants=!!s.scope.nonParticipants.length&&!s.scope.isGroupDiscussion,s.scope.displayNonParticipantGroups=!!s.scope.nonParticipants.length&&s.scope.isGroupDiscussion&&!s.scope.isSingleGroup,s.scope.displayNonParticipantGroup=!!s.scope.nonParticipants.length&&s.scope.isGroupDiscussion&&s.scope.isSingleGroup,s.scope.nonParticipantGroups=s.scope.displayNonParticipantGroups?s.getNonParticipantGroups():[],s.scope.totalNonParticipants=s.scope.nonParticipants.length,s.scope.totalParticipants=s.scope.discussionData.totalParticipants+s.scope.totalNonParticipants,s.scope.displayedNonParticipants=24,s.scope.additionalNonParticipants=s.scope.totalNonParticipants,s.scope.currentPanelWidth=0,s.scope.lastPanelWidth=-1,s.scope.isLoaded=!0;for(var i=0;i<s.scope.displayedNonParticipants;i++)s.scope.showNonparticipant[i]=!0;s.getTopComments(),s.getTopParticipants(),s.getParticipantBarChart(),s.updateNonParticipantView(),s.scope.overflowItems=s.getOverflowMenu(),s.scope.statisticsConfig=s.getSummaryInsightNumbers(),s.scope.topCommentsColumns=s.scope.displayTopComments&&s.scope.displayTopParticipants?"small-12 medium-8 large-9":"small-12",s.scope.topParticipantColumns=s.scope.displayTopComments&&s.scope.displayTopParticipants?"small-12 medium-4 large-3":"small-12"})},i.prototype.getSummaryInsightNumbers=function(){var t=this.bbLocalize.getLocale(this.scope),i=this.bbLocalize.translateSync({locale:t,key:"components.directives.discussion.insights.numParticipants"}),n=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.formattedParticipation",params:{count:this.scope.totalParticipants-this.scope.totalNonParticipants,total:this.scope.totalParticipants},noWrap:!0}),s=this.bbLocalize.translateSync({locale:t,key:"components.directives.discussion.insights.avgComments"}),e=this.bbLocalize.translateSync({locale:t,key:"components.directives.discussion.insights.avgCount"}),a=this.bbLocalize.translateSync({locale:t,key:"components.directives.discussion.insights.avgGrade"}),o=this.scope.isGradable&&this.scope.avgGradeOfDiscussion>0?this.bbLocalize.formatPercentageSync(this.scope.avgGradeOfDiscussion,this.scope):this.bbLocalize.translateSync({locale:t,key:"components.directives.discussion.insights.na"}),c=[];return c.push({title:i,data:n}),c.push({title:s,data:this.bbLocalize.formatNumberSync(this.scope.avgCommentsPerStudent,this.scope).toString()}),this.scope.avgWordCountPerComment&&this.scope.avgWordCountPerComment>0&&c.push({title:e,data:this.bbLocalize.formatNumberSync(this.scope.avgWordCountPerComment,this.scope).toString()}),this.scope.isGradable&&c.push({title:a,data:o}),c},i.prototype.getParticipantBarChart=function(){var i=0,n=0,s=100,e=this.scope.totalParticipants-this.scope.totalNonParticipants;this.scope.totalParticipants>0?s=100-((i=Math.floor((this.scope.totalParticipants-this.scope.totalNonParticipants)/this.scope.totalParticipants*100))+(n=Math.floor(this.scope.viewedOnlyCount/this.scope.totalParticipants*100))):(i=0,n=0,s=100),t(".bar-chart .participated").attr("style","width: "+i+"%"),t(".bar-chart .opened").attr("style","width: "+n+"%"),t(".bar-chart .unopened").attr("style","width: "+s+"%");var a=this.scope.totalNonParticipants-this.scope.viewedOnlyCount;this.scope.barchartNonParticipants=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.barchartNonParticipants",params:{count:a},noWrap:!0}),this.scope.barchartOpenedNonParticipants=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.barchartOpenedNonParticipants",params:{count:this.scope.viewedOnlyCount},noWrap:!0}),this.scope.barchartParticipants=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.barchartParticipants",params:{count:e},noWrap:!0}),this.scope.percentParticipatedCaption=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.percentParticipated",params:{percent:this.bbLocalize.formatPercentageSync(i/100,this.scope)},noWrap:!0}),this.scope.percentOpenedCaption=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.percentOpened",params:{percent:this.bbLocalize.formatPercentageSync((n+i)/100,this.scope)},noWrap:!0})},i.prototype.getNonParticipantGroups=function(){var t=this,i=[];return this.scope.nonParticipants.length>0&&s.forEach(this.scope.groups,function(n){var e;e={id:n.id,name:n.name,nonParticipants:[],total:0,hidden:0},s.forEach(t.scope.nonParticipants,function(i){i.group.id===n.id&&(i.localizedName=t.bbLocalize.formatUsernameSync(i,o.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),e.nonParticipants.push(i),e.total++)}),e.hidden=e.total>4?e.total-4:0,e.total>0&&i.push(e)}),i},i.prototype.getTopComments=function(){var t=this;this.scope.numberOfCommentsToDisplay=a.h()?3:5,this.scope.discussionData.topComments.forEach(function(i){var n={user:i.user,message:v.a.text(i.message),messageId:i.messageId,numReplies:i.numReplies};n.user.localizedName=t.bbLocalize.formatUsernameSync(i.user,o.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),n.user.avatarData=i.user,t.scope.topComments.push(n),t.scope.displayTopComments=!0})},i.prototype.getTopParticipants=function(){var t=this;this.scope.discussionData.topParticipants.forEach(function(i){var n={user:i.user,numComments:i.numComments,numReplies:i.numReplies};n.user.localizedName=t.bbLocalize.formatUsernameSync(i.user,o.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),n.user.avatarData=i.user,t.scope.topParticipants.push(n),t.scope.displayTopParticipants=!0})},i.prototype.getNonParticipants=function(){var t=this,i=[];return this.scope.discussionData.nonParticipants.forEach(function(n){n.avatarData=n,n.localizedName=t.bbLocalize.formatUsernameSync(n,o.ILocaleUsernameFormat.Short,null,{noWrap:!1,noEscape:!0}),i.push(n)}),i},i.prototype.toggleIndividualNonParticipantDisplay=function(){var t=this;e.defer(function(){var i,n=s.element("#discussion-insights").find(".non-participant-box").innerWidth()-30;n=n<1118?n:1118,i=2*Math.ceil((n+20)/126),t.scope.displayedNonParticipants=0;for(var e=0;e<18;e++)e<i&&e<t.scope.totalNonParticipants?(t.scope.showNonparticipant[e]=!0,t.scope.displayedNonParticipants++):t.scope.showNonparticipant[e]=!1;t.scope.additionalNonParticipants=t.scope.totalNonParticipants>t.scope.displayedNonParticipants?t.scope.totalNonParticipants-t.scope.displayedNonParticipants:0,t.scope.nonParticipationSummary=t.bbLocalize.translateSync({locale:t.bbLocalize.getLocale(t.scope),key:"components.directives.discussion.insights.nonParticipationSummary",params:{count:t.scope.displayedNonParticipants,total:t.scope.totalNonParticipants},noWrap:!0}),t.setNonParticipantMargin(n)})},i.prototype.setNonParticipantMargin=function(i){var n,s,e,a=t("li.non-participant");n=126*(s=Math.floor(i/126))+106,e=s-1>0?20+(i-n-2)/s:20+i-n,t(a).css("margin-right",e),t(a[s]).css("margin-right","2px"),2*s+1<=a.length&&t(a[2*s+1]).css("margin-right","2px")},i.prototype.updateNonParticipantView=function(){var t=this.bbLocalize.getLocale(this.scope);this.scope.nonParticipantsOptions=this.bbLocalize.translateSync({locale:t,key:"components.directives.discussion.insights.nonparticipantsOptions"}),this.scope.numberOfCommentsToDisplay=a.h()?3:5,this.scope.currentPanelWidth=s.element("#discussion-insights").find(".non-participant-box").innerWidth(),this.scope.currentPanelWidth!==this.scope.lastPanelWidth&&(a.h()?this.scope.showLargeNonparticipantPanel=!1:(this.scope.showLargeNonparticipantPanel=!0,this.toggleIndividualNonParticipantDisplay())),this.scope.lastPanelWidth=this.scope.currentPanelWidth},i.prototype.getSafeHtml=function(t){return this.$sce.trustAsHtml(t)},i.prototype.hasNavScrollbar=function(){var t=s.element(".group-selector")[0];return!!(t&&t.scrollWidth>t.clientWidth)},i.prototype.goToDiscussion=function(t){t?(this.discussion.groupId=t,this.ultraState.goPeekState("discussion.view.with-grading",{contentId:this.scope.contentId,disGroupId:t,courseId:this.scope.courseId})):this.ultraState.goPeekState("discussion.view.with-grading",{contentId:this.scope.contentId,courseId:this.scope.courseId})},i.prototype.goToGrade=function(t){this.scope.isGradable&&!this.scope.isGroupDiscussion&&this.ultraState.goPeekState("submission-list",{columnId:this.scope.gradingColumn,participantId:t,contentId:this.scope.contentId})},i.prototype.goToMessage=function(t){this.ultraState.goPeekState("message",{courseId:this.scope.courseId,recipientIds:t})},i.prototype.isFocusedNonparticipant=function(i){return t(document.activeElement).is(s.element(t("a#non-participant-link-"+i)))},i.prototype.sortNamesAlphabetically=function(t){var i="";return t.sort(function(t,i){return t.givenName+t.familyName<i.givenName+i.familyName?-1:1}).forEach(function(t){i+=t.id+","}),i.slice(0,-1)},i.prototype.goToMessageAll=function(){var t=this.sortNamesAlphabetically(this.scope.nonParticipants);this.ultraState.goPeekState("message",{courseId:this.scope.courseId,recipientIds:t,conversationPerRecipient:!0})},i.prototype.updateDfiPanel=function(i,n,s){t(".group-selector .selected").removeClass("selected"),t(i.target).addClass("selected"),n?(this.discussion.groupId=n,this.scope.currentGroupId=n,this.scope.currentGroupName=s,this.createDfiReport(this.scope.courseId,this.scope.contentId,n),this.updateNonParticipantView()):(this.discussion.groupId=void 0,this.scope.currentGroupId=void 0,this.scope.currentGroupName=void 0,this.createDfiReport(this.scope.courseId,this.scope.contentId))},i.prototype.updateMessagesCount=function(){s.element("bb-overflow-menu.ddm-nonparticipant-options:visible").find("#ddm-nonparticipant-options_messages span").text(this.scope.overflowItems[0].labelKey).attr("analytics-id",this.scope.overflowItems[0].labelKey)},i.prototype.getOverflowMenu=function(){var t=this;return[{icon:"messages",labelKey:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.messageNonParticipants",params:{count:this.scope.totalNonParticipants},noWrap:!0}),onClick:function(){t.goToMessageAll()}}]},i.$inject=["$window","$sce","scope","element","$stateParams",o.serviceName,h.b,m.c,u.d,g.o.serviceName],i}(),k=function(){function t(t){var i=this;this.$injector=t,this.restrict="EA",this.template=y,this.scope={content:"&"},this.link=function(t,n,s){t.discussionInsights=i.$injector.instantiate(w,{scope:t,element:n,attrs:s})}}return t.$inject=["$injector"],t}();s.module(P,[c.a,r.a,l.b,p.a,d.a,h.a,b.a,u.b]).directive("bbDiscussionInsights",["$injector",function(t){return t.instantiate(k)}])}).call(this,n("EVdn"))},WXD6:function(t,i,n){},XZwZ:function(t,i,n){t.exports=n("ZJ/X")(1419)},jcgw:function(t,i,n){var s=n("4BeY"),e=n("IaFt"),a=new s({id:"icon-small-messages",use:"icon-small-messages-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-messages"><path d="M1 3h14v10H1V3z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M1 3l7 7 7-7M1 13l5-5M15 13l-5-5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});e.add(a);t.exports=a},oI8f:function(t,i){t.exports='<div>\n  \x3c!-- Display a loading spinner if page is rendering --\x3e\n  <div class="telemetry-loading-anim" ng-if="telemetryPanelHeader.showSpinner">\n    <div class="spinner bb-secondary-color-2"/>\n  </div>\n  <header class="panel-header simple-header">\n    <div class="panel-titles-container">\n      <div class="panel-sub-title">{{ ::course().name }}</div>\n      <div class="black-header-contents">\n        <button class="left-off-canvas-toggle menu-toggle standard-button dark-background"\n                type="button"\n                analytics-id="components.directives.telemetry.panel.menu.button">\n          <bb-svg-icon size="small" icon="main-menu"></bb-svg-icon>\n          <span class="sr-only" bb-translate>components.directives.telemetry.panel.menu</span>\n        </button>\n        <h1 class="panel-title" ng-if="::titleKey" bb-translate>{{::titleKey}}</h1>\n        <h1 class="panel-title" ng-if="title">{{::title}}</h1>\n        \x3c!-- BUTTON 2 (displayed to the left of Button 1) --\x3e\n        <button ng-if="buttonTwoIcon" id="button-two"\n                aria-haspopup="true"\n                class="standard-button dark-background hide-for-large-up"\n                bb-translate-attrs="{\'aria-label\': buttonTwoAriaLabel,\'title\': buttonTwoTitle}"\n                ng-click="buttonTwoCallback()"\n                ng-class="{ \'active\': mobileStudentListVisible }"\n                analytics-id="components.directives.telemetry.panel.buttonwTwo.button">\n          <i class="{{ ::buttonTwoIcon }}"></i>\n          <span class="sr-only" bb-translate>buttonTwoTitle</span>\n        </button>\n        \x3c!-- BUTTON 1 (displayed on the far right) --\x3e\n        <button ng-if="buttonOneIcon"\n                id="button-one"\n                class="standard-button dark-background hide-for-large-up"\n                bb-translate-attrs="{\'aria-label\': buttonOneAriaLabel,\'title\': buttonOneTitle}"\n                ng-click="buttonOneCallback()"\n                analytics-id="components.directives.telemetry.panel.buttonOne.button">\n          <i class="{{ ::buttonOneIcon }}"></i>\n          <span class="sr-only" bb-translate>buttonOneTitle</span>\n        </button>\n      </div>\n    </div>\n  </header>\n</div>\n'},pWIa:function(t,i,n){var s=n("4BeY"),e=n("IaFt"),a=new s({id:"icon-small-main-menu",use:"icon-small-main-menu-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-main-menu"><path d="M1 3h14M15 8H1M1 13h14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});e.add(a);t.exports=a},px9Z:function(t,i,n){},qvzR:function(t,i){t.exports='<div class="panel-wrap telemetry-panel">\n  <bb-telemetry-panel-header title="{{header}}"\n                           course="course"\n                           panel-data-loaded="true">\n  </bb-telemetry-panel-header>\n\n  <nav class="group-selector" ng-class="{\'horizontal-scroll\': discussionInsights.hasNavScrollbar()}" ng-if="isGroupDiscussion">\n    <ul class="group-list">\n      <li class="group-item child-is-invokable"\n          bb-click-to-invoke-child="a.overall-link"\n          tabindex="0">\n        <a href="javascript:void(0);"\n           class="overall-link selected"\n           title="View analytics for all groups"\n           ng-click="discussionInsights.updateDfiPanel($event)"\n           bb-translate="components.directives.discussion.insights.overall"\n           analytics-id="components.directives.discussion.insights.overall">\n        </a>\n      </li>\n      <li class="group-item child-is-invokable"\n          bb-click-to-invoke-child="a.group-menu-link"\n          tabindex="0"\n          ng-repeat="group in ::groups">\n        <a href="javascript:void(0);"\n           class="group-menu-link"\n           title="View analytics for {{group.name}}"\n           ng-click="discussionInsights.updateDfiPanel($event, group.id, group.name)"\n           analytics-id="components.directives.discussion.insights.group.link">\n          {{group.name}}\n        </a>\n      </li>\n    </ul>\n  </nav>\n\n  <section id="discussion-insights" class="panel-content discussion-insights" bb-foundation-defer>\n    <div class="insights">\n      <div class="insight-summary row collapse summary-box">\n        <div class="column small-12">\n          <bb-statistics\n            config="statisticsConfig"\n            ng-if="isLoaded"\n            small-per-row="1"\n            large-per-row="4"></bb-statistics>\n        </div>\n      </div>\n\n      <div class="participation-chart-container">\n        <div class="bar-chart">\n          <span class="participated"\n                aria-label="{{barchartParticipants}}"\n                title="{{barchartParticipants}}"></span>\n          <span class="opened"\n                aria-label="{{barchartOpenedNonParticipants}}"\n                title="{{barchartOpenedNonParticipants}}"></span>\n          <span class="unopened"\n                aria-label="{{barchartNonParticipants}}"\n                title="{{barchartNonParticipants}}"></span>\n        </div>\n        <div class="legend">\n          <div class="participatedCaption" data-ng-bind-html="discussionInsights.getSafeHtml(percentParticipatedCaption)"></div>\n          <div class="openedCaption" data-ng-bind-html="discussionInsights.getSafeHtml(percentOpenedCaption)"></div>\n        </div>\n      </div>\n\n      <div class="non-participant-groups row" ng-if="displayNonParticipantGroups">\n        <div class="column small-12 non-participant-box clearfix" bb-foundation-defer>\n          <h3 class="stat-title subheader"\n              bb-translate="components.directives.discussion.insights.groupNonParticipants"\n              translate-values="{count: totalNonParticipants}"></h3>\n          <div class="float-right">\n            <bb-overflow-menu class="ddm-nonparticipant-options"\n                              element-id="ddm-nonparticipant-options"\n                              element-name={{nonParticipantsOptions}}\n                              on-menu-toggle="discussionInsights.updateMessagesCount()"\n                              menu-items="discussionInsights.getOverflowMenu()"\n                              analytics-id-tag-prefix="components.directives.discussion.insights.nonParticipantsGroups.overflowMenu">\n            </bb-overflow-menu>\n          </div>\n\n          <div class="group-nonparticipants" ng-repeat="nonParticipantGroup in nonParticipantGroups track by nonParticipantGroup.id">\n            <div class="group-heading child-is-invokable" bb-click-to-invoke-child="a.group-link">\n              <a class="group-link"\n                 href="javascript:void(0);"\n                 ng-click="discussionInsights.goToDiscussion(nonParticipantGroup.id)"\n                 analytics-id="components.directives.discussion.insights.nonParticipantGroup.link">\n                {{nonParticipantGroup.name}}\n              </a>\n            </div>\n            <div class="nonparticipant-in-group-container"\n                 ng-class="nonParticipantGroup.total > 3 ? \'space-evenly\' : \'set-margin\' ">\n              <div class="nonparticipant-in-group child-is-invokable"\n                   bb-click-to-invoke-child="a.group-non-participant-link"\n                   ng-repeat="nonParticipant in nonParticipantGroup.nonParticipants | limitTo: 4 track by nonParticipant.id">\n                <bb-avatar user="nonParticipant"></bb-avatar>\n                <a class="group-non-participant-link"\n                   href="javascript:void(0);"\n                   aria-label="{{nonParticipant.localizedName}}"\n                   ng-click="discussionInsights.goToMessage(nonParticipant.id)"\n                   analytics-id="components.directives.discussion.insights.nonParticipant.link">\n                  {{nonParticipant.localizedName}}\n                </a>\n              </div>\n            </div>\n            <div class="count-link">\n              <a ng-click="discussionInsights.goToDiscussion(nonParticipantGroup.id)"\n                 ng-show="nonParticipantGroup.hidden > 0"\n                 href="javascript:void(0);"\n                 bb-translate="components.directives.discussion.insights.moreLink"\n                 translate-values="{count: nonParticipantGroup.hidden}"\n                 analytics-id="components.directives.discussion.insights.moreLink">\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="non-participants row" ng-show="(displayNonParticipants || displayNonParticipantGroup)">\n        <div class="column small-12 non-participant-box clearfix" ng-if="showLargeNonparticipantPanel" bb-foundation-defer>\n          <h3 class="stat-title subheader" bb-translate="components.directives.discussion.insights.nonParticipants"></h3>\n          <div class="float-right">\n            <bb-overflow-menu class="ddm-nonparticipant-options"\n                              element-id="ddm-nonparticipant-options"\n                              element-name={{nonParticipantsOptions}}\n                              on-menu-toggle="discussionInsights.updateMessagesCount()"\n                              menu-items="discussionInsights.getOverflowMenu()"\n                              analytics-id-tag-prefix="components.directives.discussion.insights.nonParticipants.overflowMenu">\n            </bb-overflow-menu>\n          </div>\n          <ul class="non-participant-list clearfix">\n            <li class="non-participant child-is-invokable"\n                bb-click-to-invoke-child="a.non-participant-link"\n                tabindex="-1"\n                ng-show="showNonparticipant[$index]"\n                ng-repeat="nonParticipant in nonParticipants | limitTo: 18 track by nonParticipant.id">\n              <div class="non-participant-cell"\n                   ng-class="{\'show-focus-outline\': discussionInsights.isFocusedNonparticipant(nonParticipant.id)}">\n                <a class="non-participant-link hide-focus-outline"\n                   id="non-participant-link-{{nonParticipant.id}}"\n                   tabindex="0"\n                   href="javascript:void(0);"\n                   ng-focus="true"\n                   ng-blur="true"\n                   ng-click="discussionInsights.goToMessage(nonParticipant.id)"\n                   analytics-id="components.directives.discussion.insights.nonParticipantLink.link">\n                  <bb-avatar class="non-participant-avatar" user="nonParticipant.avatarData"></bb-avatar>\n                </a>\n                <span class="byline stacked" ng-bind-html="discussionInsights.getSafeHtml(nonParticipant.localizedName)"></span>\n              </div>\n            </li>\n          </ul>\n          <label class="summary-line">{{nonParticipationSummary}}</label>\n        </div>\n        <div class="column small-12 non-participant-box clearfix" ng-if="!showLargeNonparticipantPanel">\n          <h3 class="stat-title subheader">{{barchartNonParticipants}}</h3>\n          <button class="messageAllButton button"\n                  bb-translate="components.directives.discussion.insights.messageAll"\n                  bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.messageAll\'}"\n                  ng-click="discussionInsights.goToMessageAll()"\n                  analytics-id="components.directives.discussion.insights.messageAll">\n            </button>\n        </div>\n      </div>\n\n      <div class="row equal-height" ng-if="displayTopComments || displayTopParticipants">\n        <div class="top-comments column {{topCommentsColumns}} student-list-box" ng-if="displayTopComments">\n          <h3 class="stat-title subheader"\n              id="most-replies-heading"\n              bb-translate="components.directives.discussion.insights.mostReplies"></h3>\n          <div class="tabular-list-container">\n            <div class="tabular-row top-comment-row child-is-invokable"\n                 bb-click-to-invoke-child="a.discussion-link"\n                 ng-class="{\'last\':$last}"\n                 ng-repeat="comment in topComments | limitTo: numberOfCommentsToDisplay | orderBy: \'-numReplies\'">\n              <a href="javascript:void(0);"\n                 class="discussion-link"\n                 ng-click="discussionInsights.goToDiscussion(comment.user.group.id)"\n                 aria-labelledby="comment-user-{{comment.user.id}} most-replies-heading"\n                 aria-describedby="comment-message-{{comment.user.id}}\n                 comment-replies-{{comment.user.id}}"\n                 analytics-id="components.directives.discussion.insights.goToDiscussion.link">\n                <bb-avatar class="top-participant-avatar" user="comment.user.avatarData"></bb-avatar>\n                <div class="comment-info">\n                  <div class="comment-message ellipsis" id="comment-message-{{comment.user.id}}">{{comment.message}}</div>\n                  <div class="byline ellipsis">\n                    <span id="comment-user-{{comment.user.id}}">\n                      <bb-translate>components.directives.discussion.insights.by</bb-translate> {{comment.user.localizedName}}\n                      <span ng-show="isGroupDiscussion"><bb-translate>components.directives.discussion.insights.inGroup</bb-translate> {{comment.user.group.name}}</span>\n                    </span> |\n                    <span id="comment-replies-{{comment.user.id}}"> {{comment.numReplies}} <bb-translate>components.directives.discussion.insights.replies</bb-translate></span>\n                  </div>\n                </div>\n              </a>\n            </div>\n          </div>\n        </div>\n        <div class="top-participants column {{topParticipantColumns}} student-list-box" ng-if="displayTopParticipants">\n          <h3 id="top-heading" class="stat-title subheader" bb-translate="components.directives.discussion.insights.topParticipants"></h3>\n          <div class="tabular-list-container">\n            <div class="tabular-row top-participants-row child-is-invokable"\n                 bb-click-to-invoke-child="a.grading-panel-link"\n                 ng-class="{\'last\':$last, \'not-graded\': (!isGradable || isGroupDiscussion), \'group-row\':isGroupDiscussion}"\n                 ng-repeat="participant in topParticipants | limitTo: numberOfCommentsToDisplay | orderBy: \'-numComments\'">\n              <a href="javascript:void(0);"\n                 class="grading-panel-link"\n                 aria-labelledby="user-{{participant.user.id}} top-heading"\n                 aria-describedby="span-replies-{{participant.user.id}} span-feedback-{{participant.user.id}}"\n                 ng-class="{\'not-graded\': (!isGradable || isGroupDiscussion)}"\n                 ng-click="discussionInsights.goToGrade(participant.user.id)"\n                 analytics-id="components.directives.discussion.insights.goToGrade.link">\n                <bb-avatar class="comment-avatar" user="participant.user.avatarData"></bb-avatar>\n                <div class="top-participant-info ellipsis" ng-class="{\'not-graded\': !isGradable}">\n                  <span class="discussion-insights-heading" id="user-{{participant.user.id}}">{{participant.user.localizedName}}</span><br>\n                  <span class="ellipsis" ng-show="isGroupDiscussion">{{participant.user.group.name}}</span><br ng-show="isGroupDiscussion">\n                  <span class="byline" id="span-feedback-{{participant.user.id}}">\n                    <bb-svg-icon class="top-participant-icon" size="small" icon="feedback" bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.feedback\'}"></bb-svg-icon>\n                    {{participant.numComments}}\n                  </span>\n                  <span class="byline" id="span-replies-{{participant.user.id}}">\n                  <bb-svg-icon class="top-participant-icon" size="small" icon="replies" bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.replies\'}"></bb-svg-icon>\n                    {{participant.numReplies}}\n                  </span>\n                </div>\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div ui-view="telemetry-discussion-forum-insights-base@"></div>\n  </section>\n</div>'},r6lH:function(t,i,n){"use strict";n.d(i,"a",function(){return m}),n.d(i,"b",function(){return h});var s=n("mrSG"),e=n("LvDl"),a=n("IbG+"),o=n("jhBu"),c=n("Sa5G"),r=n("0JpG"),l=n("pjml"),p=n("wd/R"),d=n("M+Ig"),u=n("+O05"),m="ultra.service.telemetry",h="telemetry",b=function(){function t(t,i,n,s,e,a,o,c,r,l,p,d,u,m,h,b,g){this.cacheFactory=t,this.$q=i,this.entitlement=n,this.bbLocalize=s,this.ActivityVsGradeModel=e,this.ContentActivityInDetailModel=a,this.CourseActivityModel=o,this.CourseGradesModel=c,this.CourseNotificationsModel=r,this.MultimediaActivityInDetailModel=l,this.MultimediaStatisticsModel=p,this.NotificationUsers=d,this.StudentActivityModel=u,this.StudentGradesModel=m,this.SufficientDataModel=h,this.TelemetryDiscussionActivityModel=b,this.TelemetryDiscussionXrayModel=g,this.SUFFICIENT_DATA_KEY="SufficientData",this.sufficientDataCache=t.createCache("sufficientTelemetryData"),this.notificationsCache=t.createCache("notifications")}return t.prototype.loadActivityVsGradeData=function(t){return this.ActivityVsGradeModel.$find(t).$allow([404]).$asPromise()},t.prototype.loadStudentGradeData=function(t,i){return this.StudentGradesModel.$find(t,i?{userId:i}:{}).$allow([404,400]).$asPromise()},t.prototype.loadCourseGradeData=function(t){return this.CourseGradesModel.$find(t).$allow([404,400]).$asPromise()},t.prototype.loadStudentActivityData=function(t,i){return this.StudentActivityModel.$find(t,i?{userId:i}:{}).$allow([400]).$asPromise()},t.prototype.loadContentActivityInDetailData=function(t,i){return this.ContentActivityInDetailModel.$collection().getContentActivityInDetail(t,i).$asPromise()},t.prototype.loadMultimediaActivityInDetailData=function(t,i){return this.MultimediaActivityInDetailModel.$collection().getMultimediaActivityInDetail(t,i).$asPromise()},t.prototype.loadMultimediaStatisticsData=function(t,i){return this.MultimediaStatisticsModel.getMultimediaStatistics(t,i).$asPromise()},t.prototype.loadCourseActivityData=function(t){return this.CourseActivityModel.$find(t).$allow([400]).$asPromise()},t.prototype.loadNotificationUsers=function(t,i,n){var s={};return i&&(s.limit=i),n&&(s.offset=n),this.NotificationUsers.$find(t,s).$asPromise().then(function(t){return e.keyBy(t.users,"userId")})},t.prototype.loadNotifications=function(t,i,n,s){return this.getNotificationsPromise(t,i,n,s).promise},t.prototype.loadDiscussionActivityData=function(t,i,n){return n?this.TelemetryDiscussionActivityModel.getDiscussionActivityReport(t,i,n).$asPromise():this.TelemetryDiscussionActivityModel.getDiscussionActivityReport(t,i).$asPromise()},t.prototype.loadDiscussionXrayReport=function(t,i,n){return this.TelemetryDiscussionXrayModel.getDiscussionXrayReport(t,i,n).$asPromise()},t.prototype.hasSufficientActivityData=function(t){return this.getSufficientDataPromise().promise.then(function(i){return!(!i||!i.coursesWithActivity)&&e.includes(i.coursesWithActivity,t)})},t.prototype.hasSufficientGradeData=function(t){return this.getSufficientDataPromise().promise.then(function(i){return!(!i||!i.coursesWithGrades)&&e.includes(i.coursesWithGrades,t)})},t.prototype.canViewAllUserData=function(t){return this.entitlement.hasCourseEntitlement(c.v.ViewGrades,t)},t.prototype.formatMessageRecipients=function(t){return(t||[]).map(function(t){return t.id}).join(",")},t.prototype.determineContentSupportsActivityData=function(t){var i=this.$q.defer();return u.a.isExternalSubmissionsAssessment(t)?i.resolve(!1):this.contentSupportsActivityData(t)?this.canViewAllUserData(t.courseId).then(function(t){i.resolve(t)}).catch(function(t){i.reject(t)}):i.resolve(!1),i.promise},t.prototype.contentSupportsActivityData=function(t){return(c.g.TestLink.isEqualTo(t.contentHandler)||c.g.UltraAssignment.isEqualTo(t.contentHandler))&&t.hasGradingColumn()},t.prototype.determinePanelSref=function(t,i){var n=this,s=this.$q.defer(),e={hasGrades:this.hasSufficientGradeData(t),hasActivity:this.hasSufficientActivityData(t),canViewAllUserData:this.canViewAllUserData(t)};return this.$q.all(e).then(function(e){e.hasGrades&&e.hasActivity?e.canViewAllUserData?s.resolve(n.createPanelSref(d.a.InstructorClass,t,i)):s.resolve(n.createPanelSref(d.a.StudentProgress,t,i)):s.reject()}).catch(function(t){s.reject(t)}),s.promise},t.prototype.createPanelSref=function(t,i,n){var s='({ courseId: "'+i+'"';return n&&(s+=', notificationId: "'+n+'"'),t.toString()+(s+=" })")},t.prototype.exportFilename=function(t,i,n,s,e){var a="";t&&(a=t.courseId+"_");var o=this.bbLocalize.formatDateSync(new Date,r.ILocaleDateFormat.ISO).replace(/[^0-9]/g,""),c="";i&&n&&i.id!==n.id&&(c=i.userName+"_");var l=s?"_"+s:"",p="";return e&&(p=e.replace(/\s+/g,"_")+"_"),a+c+p+o+l},t.prototype.getSufficientDataPromise=function(){var t=this.sufficientDataCache.get(this.SUFFICIENT_DATA_KEY);return t||(t={promise:this.SufficientDataModel.$new().$fetch().$allow([404,400]).$asPromise()},this.sufficientDataCache.put(this.SUFFICIENT_DATA_KEY,t)),t},t.prototype.getNotificationsPromise=function(t,i,n,s){var e=t+i+n+s,a=this.notificationsCache.get(e);if(!a){var o={};i&&(o.userId=i),n&&(o.includeDismissed=n),s&&(o.notificationType=s),(a={promise:this.CourseNotificationsModel.$find(t,o).$asPromise()}).promise.then(function(t){return t.currentStudent.forEach(function(t){t.ui={createdDay:p.utc(t.created).startOf("day").toDate()}}),t}),this.notificationsCache.put(e,a)}return a},t.$inject=["DSCacheFactory","$q",o.b,r.serviceName,l.zb.serviceName,l.Ab.serviceName,l.Bb.serviceName,l.Cb.serviceName,l.Db.serviceName,l.Gb.serviceName,l.Hb.serviceName,l.Jb.serviceName,l.Kb.serviceName,l.Lb.serviceName,l.Mb.serviceName,l.Eb.serviceName,l.Fb.serviceName],t}();!function(t){function i(){return null!==t&&t.apply(this,arguments)||this}s.__extends(i,t)}(b);a.module(m,[l.R,o.a]).service(h,b)},suMx:function(t,i,n){"use strict";n("WXD6"),n("XZwZ");var s=n("IbG+"),e=n("S3dm"),a="ultra.components.directives.statistics.complexStatistic",o=function(){function t(t,i,n){this.scope=t,this.element=i,this.$compile=n;var s=this.$compile(this.scope.item().complexTemplate)(this.scope.item().complexScope);i.append(s)}return t.$inject=["scope","element","$compile"],t}(),c=function(){function t(t){var i=this;this.$injector=t,this.replace=!0,this.restrict="A",this.template=e,this.scope={item:"&"},this.link=function(t,n){t.complexStatistic=i.$injector.instantiate(o,{scope:t,element:n})}}return t.$inject=["$injector"],t}();s.module(a,[]).directive("bbComplexStatistic",["$injector",function(t){return t.instantiate(c)}]);var r=n("Mm3V"),l=function(){function t(t,i){this.scope=t,this.$sce=i,this.scope.item().trusted=i.trustAsHtml(this.scope.item().data)}return t.$inject=["scope","$sce"],t}(),p=function(){function t(t){var i=this;this.$injector=t,this.replace=!0,this.restrict="A",this.template=r,this.scope={item:"&"},this.link=function(t){t.simpleStatistic=i.$injector.instantiate(l,{scope:t})}}return t.$inject=["$injector"],t}();s.module("ultra.components.directives.statistics.simpleStatistic",[]).directive("bbSimpleStatistic",["$injector",function(t){return t.instantiate(p)}]);var d=n("BBHJ");n.d(i,"a",function(){return u});var u="ultra.components.directives.statistics",m=function(){function t(t){var i=this;this.scope=t,this.smallPerRow=t.smallPerRow()||1,this.largePerRow=t.largePerRow()||4,this.scope.$watch("config()",function(t){t&&(i.config=t.length>10?t.slice(0,10):t,i.total=i.config.length)})}return t.$inject=["scope"],t}(),h=function(){function t(t){var i=this;this.$injector=t,this.replace=!0,this.restrict="AE",this.template=d,this.scope={config:"&",smallPerRow:"&",largePerRow:"&"},this.link=function(t){t.statistics=i.$injector.instantiate(m,{scope:t})}}return t.$inject=["$injector"],t}();s.module(u,["dibari.angular-ellipsis",a,"ultra.components.directives.statistics.simpleStatistic"]).directive("bbStatistics",["$injector",function(t){return t.instantiate(h)}])}}]);