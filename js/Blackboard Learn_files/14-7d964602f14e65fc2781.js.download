(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"/ObN":function(e,t,n){},"0fFc":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("q1tI"),r=n("i8i4"),o=n("opNB"),s=n("61QS"),i=n("CewW"),c=n("/MKj"),l=n("J8LU"),u=n("YMBy");t.PanelModeEnum=u.default;var m=function(e,t,n,o,s){var i=n;null==n&&"undefined"!=typeof window&&window.location.search.match("setLang=")&&(i=window.location.search.match(/setLang=([^$&]+)/)[1]),r.render(a.createElement(l.Locale,{locale:i,babelfishInstance:o,babelfishFormatInstance:s,bundlesToLoad:["announcements/locales/[locale]/announcements.json"]},a.createElement("div",null,e)),t)};t.renderAnnouncementListPanel=function(e,t,n,r,s,i,l,u){m(a.createElement(c.Provider,{store:t},a.createElement(o.default,{courseId:i,permissions:l,root:e,openAnnouncementDetailPanel:u})),e,n,r,s)},t.renderAnnouncementDetailPanel=function(e,t,n,r,o,i,l,u,d,p){m(a.createElement(c.Provider,{store:t},a.createElement(s.default,{courseId:i,announcementId:l,permissions:u,mode:d,closePanel:p})),e,n,r,o)},t.renderAnnouncementSlide=function(e,t,n,r,o,s,l,u){m(a.createElement(c.Provider,{store:t},a.createElement(i.default,{courseColorClass:s,fetchAnnouncementSlides:l,dismissAnnouncementItem:u})),e,n,r,o)};var d={renderAnnouncementListPanel:t.renderAnnouncementListPanel,destroyAnnouncementListPanel:function(e){r.unmountComponentAtNode(e)},renderAnnouncementDetailPanel:t.renderAnnouncementDetailPanel,destroyAnnouncementDetailPanel:function(e){r.unmountComponentAtNode(e)},renderAnnouncementSlide:t.renderAnnouncementSlide,destroyAnnouncementSlide:function(e){r.unmountComponentAtNode(e)}};t.default=d},"18SX":function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n("q1tI"),s=n("LvDl"),i=n("HIKz"),c=n("y9V7");n("a99v");var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={text:"",isCollapsed:!1,isValidSearch:!1,shouldNotify:!0},t.debouncedSearch=s.debounce(function(){var e=t.props,n=e.courseId,a=(e.notifyStateChange,e.searchAnnouncements);t.setState({shouldNotify:!0}),t.state.isValidSearch&&a(n,{searchText:encodeURIComponent(t.state.text.trim())})},t.props.debounceTime),t.focusElement=function(e){e.focus()},t.shouldStartSearching=function(e){return!e.trim().length||e.trim().length>=t.props.minCharToStartSearching},t.showCharacterInsufficient=function(e){return!!e.trim()&&e.trim().length<t.props.minCharToStartSearching},t.handleSearchTextChange=function(e){var n=e.target.value;t.setState({text:n,isValidSearch:t.shouldStartSearching(n),shouldNotify:!1}),t.debouncedSearch()},t.handleEnterToSearch=function(e){var n=t.props,a=n.searchAnnouncements,r=n.courseId,o=n.notifyStateChange;"Enter"===e.key&&(t.setState({isValidSearch:t.state.text.trim().length>0}),t.state.isValidSearch&&(o(t.state.text,t.state.isCollapsed,t.state.isValidSearch),a(r,{searchText:encodeURIComponent(t.state.text.trim())})))},t.closeSearchInput=function(){t.setState({text:"",isCollapsed:!0,isValidSearch:!1})},t}return r(t,e),t.prototype.componentWillReceiveProps=function(e){e.isCollapsed&&!e.searchText.trim().length&&this.debouncedSearch.cancel(),this.setState({text:e.searchText,isCollapsed:e.isCollapsed})},t.prototype.componentDidUpdate=function(e,t){var n=this.props,a=n.isCollapsed,r=n.notifyStateChange;!0===e.isCollapsed&&a!==e.isCollapsed&&this.focusElement(this.searchInput),this.showCharacterInsufficient(this.state.text)?this.searchInput.addEventListener("keyup",this.handleEnterToSearch):this.searchInput.removeEventListener("keyup",this.handleEnterToSearch),this.state.shouldNotify&&r(this.state.text,this.state.isCollapsed,this.state.isValidSearch)},t.prototype.render=function(){var e=this,t=this.props,n=t.localize,a=t.analyticsId,r=(0,t.analyticsEventAugmentor)("click",function(){},a);return o.createElement("div",{className:"search-input-wrap"},o.createElement(i.SvgIcon,{className:"search-icon",iconSize:"small",iconName:"search"}),o.createElement("label",{className:"sr-only",htmlFor:"search-input"},this.props.placeHolder),o.createElement("input",{className:"left",id:"search-input",onChange:this.handleSearchTextChange,placeholder:this.props.placeHolder,ref:function(t){e.searchInput=t},type:"text",value:this.state.text,onClick:r}),o.createElement(i.IconButton,{ariaLabel:n.translate("course.announcements.button.closeSearch"),className:"search-controls button super-clear",iconProps:{iconName:"close",iconSize:"small"},onClick:this.closeSearchInput,title:n.translate("course.announcements.button.closeSearch"),analyticsId:"course.announcements.listPanel.closeSearch.button"}))},t}(o.PureComponent);t.SearchInput=l,t.default=c.withAnalytics(l)},"3i8j":function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n("q1tI"),s=n("HIKz"),i=n("hTOW"),c=n("y9V7");n("yYIW"),t.getDatePickerDefaultStrings=function(e){return{months:[e.translate("course.announcements.datePicker.months.january"),e.translate("course.announcements.datePicker.months.february"),e.translate("course.announcements.datePicker.months.march"),e.translate("course.announcements.datePicker.months.april"),e.translate("course.announcements.datePicker.months.may"),e.translate("course.announcements.datePicker.months.june"),e.translate("course.announcements.datePicker.months.july"),e.translate("course.announcements.datePicker.months.august"),e.translate("course.announcements.datePicker.months.september"),e.translate("course.announcements.datePicker.months.october"),e.translate("course.announcements.datePicker.months.november"),e.translate("course.announcements.datePicker.months.december")],shortMonths:[e.translate("course.announcements.datePicker.shortMonths.january"),e.translate("course.announcements.datePicker.shortMonths.february"),e.translate("course.announcements.datePicker.shortMonths.march"),e.translate("course.announcements.datePicker.shortMonths.april"),e.translate("course.announcements.datePicker.shortMonths.may"),e.translate("course.announcements.datePicker.shortMonths.june"),e.translate("course.announcements.datePicker.shortMonths.july"),e.translate("course.announcements.datePicker.shortMonths.august"),e.translate("course.announcements.datePicker.shortMonths.september"),e.translate("course.announcements.datePicker.shortMonths.october"),e.translate("course.announcements.datePicker.shortMonths.november"),e.translate("course.announcements.datePicker.shortMonths.december")],days:[e.translate("course.announcements.datePicker.days.sunday"),e.translate("course.announcements.datePicker.days.monday"),e.translate("course.announcements.datePicker.days.tuesday"),e.translate("course.announcements.datePicker.days.wednesday"),e.translate("course.announcements.datePicker.days.thursday"),e.translate("course.announcements.datePicker.days.friday"),e.translate("course.announcements.datePicker.days.saturday")],shortDays:[e.translate("course.announcements.datePicker.shortDays.sunday"),e.translate("course.announcements.datePicker.shortDays.monday"),e.translate("course.announcements.datePicker.shortDays.tuesday"),e.translate("course.announcements.datePicker.shortDays.wednesday"),e.translate("course.announcements.datePicker.shortDays.thursday"),e.translate("course.announcements.datePicker.shortDays.friday"),e.translate("course.announcements.datePicker.shortDays.saturday")],goToToday:e.translate("course.announcements.datePicker.goToToday"),prevMonthAriaLabel:e.translate("course.announcements.datePicker.prevMonthAriaLabel"),nextMonthAriaLabel:e.translate("course.announcements.datePicker.nextMonthAriaLabel"),prevYearAriaLabel:e.translate("course.announcements.datePicker.prevYearAriaLabel"),nextYearAriaLabel:e.translate("course.announcements.datePicker.nextYearAriaLabel")}};var l=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isDisplayCalendar:!1,uiDateStr:""},t.timeoutPromiseWrapper=function(e,n,a){return new Promise(function(r){e.apply(t,n),setTimeout(function(){var t=e.apply(a,n);r(t)})})},t.errorMessage=function(){var e=t.props,n=e.isValueValid,a=e.errorEmptyMessage,r=e.errorFormatMessage;if(n)return null;var i=r;return t.state.uiDateStr||(i=a),o.createElement("span",{className:"error-message"},o.createElement(s.SvgIcon,{iconSize:"small",iconName:"attention"}),i)},t.toggleCalendar=function(){t.setState({isDisplayCalendar:!t.state.isDisplayCalendar},function(){t.state.isDisplayCalendar&&setTimeout(function(){t.calRef.focus()},100)})},t.onSelectDate=function(e){var n=t.props,a=n.localize,r=n.onChangeValue;t.timeoutPromiseWrapper(a.formatDate,[e,i.ILocaleDateFormat.Short],a).then(function(n){r(e),t.setState({uiDateStr:n}),t.toggleCalendar()})},t.onTypeDate=function(e){t.setState({uiDateStr:e.target.value})},t.onHandleBlur=function(){var e=t.state.uiDateStr,n=t.props,a=n.onChangeValue,r=n.localize;setTimeout(function(){t.datePickerRef.contains(document.activeElement)||t.setState({isDisplayCalendar:!1})}),t.timeoutPromiseWrapper(r.parseDate,[e,i.ILocaleDateFormat.Short],r).then(function(e){e&&a(e)})},t}return r(n,e),n.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.value,a=t.onChangeValue,r=t.localize;n&&this.timeoutPromiseWrapper(r.formatDate,[n,i.ILocaleDateFormat.Short],r).then(function(t){a(n),e.setState({uiDateStr:t})})},n.prototype.componentDidUpdate=function(e,t){var n=this,a=this.state.uiDateStr,r=this.props,o=r.value,s=r.onValidateCallback,c=r.localize;o&&o!==e.value&&this.timeoutPromiseWrapper(c.formatDate,[o,i.ILocaleDateFormat.Short],c).then(function(e){n.setState({uiDateStr:e}),s(!0)}),this.state.uiDateStr!==t.uiDateStr&&this.timeoutPromiseWrapper(c.parseDate,[a,i.ILocaleDateFormat.Short],c).then(function(e){s(!!e)})},n.prototype.render=function(){var e=this,n=this.state,a=n.isDisplayCalendar,r=n.uiDateStr,i=this.props,c=i.value,l=i.disabled,u=i.localize,m=i.analyticsId,d=(0,i.analyticsEventAugmentor)("click",function(){},m+".input.text");return o.createElement("div",{ref:function(t){return e.datePickerRef=t},className:"date-picker"},o.createElement("div",{className:"calendar-input-container"},o.createElement("input",{className:"date-input",ref:function(t){return e.dateInputRef=t},type:"text",value:r,onChange:this.onTypeDate,disabled:l,onClick:d}),o.createElement(s.IconButton,{ariaLabel:u.translate("course.announcements.datePicker.dueDate"),className:"btn-date open-datepicker",disabled:l,iconProps:{iconName:"calendar",iconSize:"small"},onClick:this.toggleCalendar,title:u.translate("course.announcements.datePicker.dueDate"),analyticsId:m+".open.button"}),this.errorMessage()),a&&o.createElement(s.Callout,{target:this.dateInputRef,doNotLayer:!0,directionalHint:5,isBeakVisible:!1,gapSpace:0,setInitialFocus:!1},o.createElement(s.Calendar,{componentRef:function(t){return e.calRef=t},className:"date-picker-dropdown",value:c,strings:t.getDatePickerDefaultStrings(u),isMonthPickerVisible:!1,showGoToToday:!1,onSelectDate:this.onSelectDate,analyticsId:m+".calendar"})))},n}(o.PureComponent);t.DatePicker=l,t.default=c.withAnalytics(l)},"61QS":function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n("q1tI"),i=n("/MKj"),c=n("wd/R"),l=n("J8LU"),u=n("HIKz"),m=n("YMBy"),d=n("PcON"),p=n("3i8j"),h=n("nPfc");n("LwTs");var f=256,v=n("z1U9"),S=n("PcON"),g=n("ANjH"),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={currentAnnouncement:null,title:"",rawText:"",isSaving:!1,isValid:!1,isDraft:!1,isScheduleChecked:!1,isEndChecked:!1,startDate:null,startTime:null,endDate:null,endTime:null,isStartDateValid:!0,isStartTimeValid:!0,isEndDateValid:!0,isEndTimeValid:!0},t.mappingAnnouncementToState=function(e){var n=t.props,a=n.courseId,r=n.courseContext,o=n.getCourseContext;if(e){var s=e.title,i=void 0===s?"":s,l=e.startDateRestriction,u=e.endDateRestriction,d=e.isDraft,p=e.body&&e.body.rawText||"";t.setState({currentAnnouncement:e,title:i,rawText:p,isValid:!!i.trim()&&!!p.trim(),isDraft:d}),d||(t.setState({isScheduleChecked:!0,startDate:c(l).toDate(),startTime:c(l).toDate()}),u&&t.setState({isScheduleChecked:!0,isEndChecked:!0,endDate:c(u).toDate(),endTime:c(u).toDate()}))}r&&r.courseId===a||o(a);var h=t.getMode();t.titleTextField&&t.isEditableMode(h)&&t.titleTextField.focus(),t.updateAnnouncementPanelState(m.default.DUPLICATE.isEqualTo(h),!1)},t.getMode=function(){return t.props.mode||m.default.VIEW},t.isEditableMode=function(e){return m.default.EDIT.isEqualTo(e)||m.default.DUPLICATE.isEqualTo(e)||m.default.CREATE.isEqualTo(e)},t.onTitleChange=function(e){t.setState({title:e,isValid:!!e.trim()&&e.trim().length<=f&&!!t.state.rawText.trim()}),t.updateAnnouncementPanelState(!!e.trim())},t.onRawTextChange=function(e){t.setState({rawText:e,isValid:!!e.trim()&&!!t.state.title.trim()&&t.state.title.trim().length<=f}),t.updateAnnouncementPanelState(!!e.trim())},t.onErrorMessage=function(e){return e.length?"":t.props.localize.translate("course.announcements.errors.messages.messageRequired")},t.onTitleErrorMessage=function(e){var n="";return e.trim().length?e.trim().length>f&&(n=t.props.localize.translate("course.announcements.errors.messages.titleMaxlength",{maxLength:f})):n=t.props.localize.translate("course.announcements.errors.messages.titleRequired"),n},t.onSave=function(){if(!t.state.isSaving){t.setState({isSaving:!0});var e=t.getMode(),n=t.state,a=n.currentAnnouncement,r=n.title,s=n.rawText,i=n.isScheduleChecked,c=n.isEndChecked,l=n.startDate,u=n.startTime,d=n.endDate,p=n.endTime,h=t.props,f=h.courseId,v=h.saveAnnouncement,g=h.closePanel;if(!a&&m.default.CREATE.isEqualTo(e))(a={}).isDraft=!0,a.title=r,a.body={rawText:s},i&&(a.isDraft=!1,a.startDateRestriction=S.buildDateTimeMoment(l,u).toISOString(),a.endDateRestriction=c?S.buildDateTimeMoment(d,p).toISOString():"");else{if(!m.default.DUPLICATE.isEqualTo(e)&&!m.default.EDIT.isEqualTo(e))return console.error("Failed to save announcement!"),void t.setState({isSaving:!1});var y=o({},a.body,{rawText:s});a=o({},a,{title:r,body:y}),m.default.DUPLICATE.isEqualTo(e)&&(a=o({},a,{isDraft:!0,id:null})),i?(a.isDraft=!1,a.startDateRestriction=S.buildDateTimeMoment(l,u).toISOString(),a.endDateRestriction=c?S.buildDateTimeMoment(d,p).toISOString():""):(a.isDraft=!0,a.startDateRestriction="",a.endDateRestriction="")}v(f,a).then(function(){t.updateAnnouncementPanelState(!1,!0),g()})}},t.onCancel=function(){t.props.closePanel()},t.validateInputs=function(){return!!t.state.title.trim()&&!!t.state.rawText.trim()&&t.state.title.trim().length<=f},t.validateSchedule=function(){var e=t.state,n=e.isScheduleChecked,a=e.isEndChecked,r=e.isStartDateValid,o=e.isStartTimeValid,s=e.isEndDateValid,i=e.isEndTimeValid;if(n){if(!r||!o)return!1;if(a&&(!s||!i))return!1}return!0},t.onScheduleChange=function(){t.updateAnnouncementPanelState(!0),t.setState({isScheduleChecked:!t.state.isScheduleChecked})},t.onHideOnChange=function(){t.setState({isEndChecked:!t.state.isEndChecked}),t.updateAnnouncementPanelState(!0)},t.isEndLaterThanStart=function(){var e=t.state,n=e.isScheduleChecked,a=e.isEndChecked,r=e.isStartDateValid,o=e.isStartTimeValid,s=e.isEndDateValid,i=e.isEndTimeValid,c=e.startDate,l=e.startTime,u=e.endDate,m=e.endTime;return!(n&&a&&r&&o&&s&&i&&u&&m)||S.buildDateTimeMoment(u,m).diff(S.buildDateTimeMoment(c,l))>0},t}return r(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.courseId,a=t.announcementId,r=t.announcements,o=t.announcement,s=t.getAnnouncement,i=t.permissions;m.default.CREATE.isEqualTo(this.getMode())?i.create?this.mappingAnnouncementToState(null):console.error("User is not authorized to create announcement!"):r&&r[a]?this.mappingAnnouncementToState(r[a]):o&&o.id===a?this.mappingAnnouncementToState(o):a?s(n,a).then(function(){e.mappingAnnouncementToState(e.props.announcement)}):console.error("Unexpected behavior!")},t.prototype.componentDidUpdate=function(e,t){if(this.state.isScheduleChecked!==t.isScheduleChecked&&this.state.isScheduleChecked&&(this.state.startDate&&this.state.startTime||this.setState({startDate:c().toDate(),startTime:c().toDate()})),this.state.isEndChecked!==t.isEndChecked&&this.state.isEndChecked&&(!this.state.endDate||!this.state.endTime)){var n=this.state,a=n.startDate,r=n.startTime;this.setState({endDate:c(a).add(1,"days").toDate(),endTime:c(r).add(1,"days").toDate()})}},t.prototype.updateAnnouncementPanelState=function(e,t){void 0===t&&(t=!1),this.props.changeAnnouncementPanelState({isDirty:e,isSaved:t})},t.prototype.render=function(){var e=this,t=this.state.currentAnnouncement,n=t&&t.body&&d.decodeOnlyAngleBracketHtmlEntities(t.body.rawText)||"",a=this.getMode(),r=this.props,o=r.permissions,i=r.courseContext,c=r.localize,l=this.state,f=l.isSaving,v=l.isValid,S=l.isScheduleChecked,g=l.isEndChecked,y=l.startDate,C=l.startTime,E=l.endDate,b=l.endTime,P=l.isStartDateValid,D=l.isStartTimeValid,I=l.isEndDateValid,w=l.isEndTimeValid,T=t&&d.decodeHtmlEntities(t.title)||"";return m.default.CREATE.isEqualTo(a)?T=c.translate("course.announcements.newAnnouncement"):m.default.EDIT.isEqualTo(a)?T=c.translate("course.announcements.editAnnouncement",{announcement:T}):m.default.DUPLICATE.isEqualTo(a)&&(T=c.translate("course.announcements.copyAnnouncement",{announcement:T})),(o.viewUnposted||m.default.VIEW.isEqualTo(a))&&s.createElement("div",{className:"announcement-detail-panel"},m.default.VIEW.isEqualTo(a)&&s.createElement("div",{className:"panel-wrap"},s.createElement("header",{className:"panel-header simple-header"},s.createElement("div",{className:"panel-titles-container"},s.createElement("span",{className:"panel-sub-title"},c.translate(d.resolveCourseOrgToken("announcements.pageTitle",i))),s.createElement("div",{className:"editable-title-container black-header-contents"},s.createElement(u.IconButton,{className:"left-off-canvas-toggle menu-toggle  standard-button dark-background",iconProps:{iconName:"main-menu"},title:c.translate("base.menu"),ariaLabel:c.translate("base.menu"),analyticsId:"course.announcements.detailPanel.menu.button"}),s.createElement("h1",{className:"panel-title",title:T},T)))),s.createElement("section",{className:"panel-container panel-content"},s.createElement("textarea",{className:"body-text",value:n,readOnly:!0}))),this.isEditableMode(a)&&s.createElement("div",{className:"peek-panel-with-footer"},s.createElement("div",{className:"panel-wrap"},s.createElement("header",{className:"panel-header simple-header"},s.createElement("div",{className:"panel-titles-container"},s.createElement("span",{className:"panel-sub-title"},i&&i.displayName||""),s.createElement("div",{className:"editable-title-container black-header-contents"},s.createElement(u.IconButton,{className:"left-off-canvas-toggle menu-toggle standard-button dark-background",iconProps:{iconName:"main-menu"},title:c.translate("base.menu"),ariaLabel:c.translate("base.menu"),analyticsId:"course.announcements.detailPanel.menu.button"}),s.createElement("h1",{className:"panel-title",title:T},T)))),s.createElement("section",{className:"panel-container panel-content"},s.createElement(u.TextField,{className:"label-decorator",label:c.translate("course.announcements.detail.title"),value:d.decodeHtmlEntities(this.state.title),onChanged:this.onTitleChange,placeholder:c.translate("course.announcements.detail.titleDesc"),ref:function(t){e.titleTextField=t},onGetErrorMessage:this.onTitleErrorMessage,required:!0,analyticsId:"course.announcements.detailPanel.title.input.text"}),s.createElement(u.Dropdown,{label:c.translate("course.announcements.detail.recipients"),defaultSelectedKey:"all",required:!0,options:[{key:"all",text:c.translate(d.resolveCourseOrgToken("announcements.detail.allRecipients",i),{studentCount:i&&i.membershipCount||0})}],analyticsId:"course.announcements.detailPanel.recipients.dropdown"}),s.createElement(u.TextField,{className:"label-decorator",label:c.translate("course.announcements.detail.message"),value:d.decodeOnlyAngleBracketHtmlEntities(this.state.rawText),onChanged:this.onRawTextChange,multiline:!0,autoAdjustHeight:!0,placeholder:c.translate("course.announcements.detail.messageDesc"),onGetErrorMessage:this.onErrorMessage,required:!0,analyticsId:"course.announcements.detailPanel.message.input.text"}),s.createElement("div",null,s.createElement(u.Checkbox,{label:c.translate("course.announcements.button.schedule"),checked:S,onChange:this.onScheduleChange,analyticsId:"course.announcements.detailPanel.scheduleAnnouncement.input.checkbox"}),S&&s.createElement("div",null,s.createElement("div",null,s.createElement(u.Checkbox,{label:c.translate("course.announcements.dateTimePicker.showOn"),disabled:!0,defaultChecked:!0,analyticsId:"course.announcements.detailPanel.showOn.input.checkbox"}),s.createElement("div",{className:"row collapse date-time-inputs"},s.createElement("div",{className:"columns small-6"},s.createElement(p.default,{value:y,onChangeValue:function(t){e.setState({startDate:t})},onValidateCallback:function(t){e.setState({isStartDateValid:t})},isValueValid:P,errorFormatMessage:c.translate("components.directives.validation.messages.errors.date"),errorEmptyMessage:c.translate("components.directives.content-visibility.startDateError"),localize:c,analyticsId:"course.announcements.detailPanel.showOn.datePicker"})),s.createElement("div",{className:"columns small-6"},s.createElement(h.default,{value:C,onChangeValue:function(t){e.setState({startTime:t})},onValidateCallback:function(t){e.setState({isStartTimeValid:t})},isValueValid:D,localize:c,errorFormatMessage:c.translate("components.directives.validation.messages.errors.time"),errorEmptyMessage:c.translate("components.directives.content-visibility.startTimeError"),analyticsId:"course.announcements.detailPanel.showOn.timePicker"})))),s.createElement("div",null,s.createElement(u.Checkbox,{label:c.translate("course.announcements.dateTimePicker.hideOn"),checked:g,onChange:this.onHideOnChange,analyticsId:"course.announcements.detailPanel.hideOn.input.checkbox"}),s.createElement("div",{className:"row collapse date-time-inputs"},s.createElement("div",{className:"columns small-6"},s.createElement(p.default,{value:E,onChangeValue:function(t){e.setState({endDate:t})},onValidateCallback:function(t){e.setState({isEndDateValid:t})},isValueValid:I||!g,disabled:!g,errorFormatMessage:c.translate("components.directives.validation.messages.errors.date"),errorEmptyMessage:c.translate("components.directives.content-visibility.endDateError"),localize:c,analyticsId:"course.announcements.detailPanel.hideOn.datePicker"})),s.createElement("div",{className:"columns small-6"},s.createElement(h.default,{value:b,onChangeValue:function(t){e.setState({endTime:t})},onValidateCallback:function(t){e.setState({isEndTimeValid:t})},isValueValid:w||!g,localize:c,disabled:!g,errorFormatMessage:c.translate("components.directives.validation.messages.errors.time"),errorEmptyMessage:c.translate("components.directives.content-visibility.endTimeError"),analyticsId:"course.announcements.detailPanel.hideOn.timePicker"})))),!this.isEndLaterThanStart()&&s.createElement("span",{className:"error-message"},s.createElement(u.SvgIcon,{iconSize:"small",iconName:"attention"}),c.translate("course.announcements.errors.messages.hideOnShouldLaterThanShowOn")))))),s.createElement("footer",{className:"panel-footer"},s.createElement("span",{className:"place-holder"}),s.createElement(u.DefaultButton,{className:"button-cancel",onClick:this.onCancel,text:c.translate("course.announcements.button.cancel"),analyticsId:"course.announcements.detailPanel.cancel.button"}),s.createElement(u.PrimaryButton,{className:"button-save",disabled:!(v&&this.validateSchedule()&&this.isEndLaterThanStart()),onClick:this.onSave,text:c.translate("course.announcements.button.save"),analyticsId:"course.announcements.detailPanel.save.button"}))),f?s.createElement("div",{className:"spinner bb-secondary-color-2"}):"")},t}(s.Component);t.AnnouncementDetailPanel=y,t.default=i.connect(function(e){return{announcements:e.announcement.announcements,courseContext:e.announcement.courseContext,announcement:e.announcement.announcement,detailPanelState:e.announcement.detailPanelState}},function(e){return g.bindActionCreators({saveAnnouncement:v.actions.announcement.saveAnnouncement,getCourseContext:v.actions.announcement.getCourseContext,getAnnouncement:v.actions.announcement.getAnnouncement,changeAnnouncementPanelState:v.actions.announcement.changeAnnouncementPanelState},e)})(l.localizedComponentWrapper(y))},"701c":function(e,t,n){},CewW:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n("q1tI"),i=n("/MKj"),c=n("J8LU"),l=n("HIKz"),u=n("wJtl"),m=n("z1U9"),d=n("PcON");n("zYff");var p=n("ANjH"),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={currentAnnouncement:null,currentViewingIndex:-1,showModal:!1},t.onDismiss=function(){t.props.dismissAnnouncementItem(t.state.currentAnnouncement.sourceEntry).then(function(){t.setState({currentViewingIndex:-1,currentAnnouncement:null})}),t.onCloseSlideModal()},t.onClickNext=function(){t.state.currentAnnouncement.isRead?t.goToNextSlide():t.props.dismissAnnouncementItem(t.state.currentAnnouncement.sourceEntry).then(function(){t.announcementSlides[t.state.currentViewingIndex]=o({},t.announcementSlides[t.state.currentViewingIndex],{isRead:!0}),t.goToNextSlide()})},t.goToNextSlide=function(){var e=++t.state.currentViewingIndex;t.setState({currentViewingIndex:e,currentAnnouncement:o({},t.announcementSlides[e])},t.updateContext)},t.onClickPrevious=function(){var e=--t.state.currentViewingIndex;t.setState({currentViewingIndex:e,currentAnnouncement:o({},t.announcementSlides[e])},t.updateContext)},t.updateContext=function(){var e=t.state,n=e.currentViewingIndex,a=e.currentAnnouncement,r=t.props,o=r.courseContext,s=r.getCourseContext;a&&a.courseId&&n>=0&&(o&&o.courseId===a.courseId||s(a.courseId))},t.onCloseSlideModal=function(){t.setState({showModal:!1})},t}return r(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.fetchAnnouncementSlides().then(function(t){t.sort(function(e,t){return e.startDateRestriction&&t.startDateRestriction?e.startDateRestriction.localeCompare(t.startDateRestriction):0}),e.announcementSlides=t.slice(),e.announcementSlides.length>0&&e.setState({currentViewingIndex:0,currentAnnouncement:o({},e.announcementSlides[0]),showModal:!0},e.updateContext)})},t.prototype.render=function(){var e=this.state,t=e.currentViewingIndex,n=e.currentAnnouncement;if(null===n||t<0)return s.createElement("div",null);var a=this.announcementSlides.length,r=1===a||t===a-1,o=1===a||0===t,i=this.props,c=i.localize,m=i.courseContext,p=d.decodeHtmlEntities(n.title),h=n.body?d.decodeOnlyAngleBracketHtmlEntities(n.body.rawText):"";return s.createElement(u.Modal,{isOpen:this.state.showModal,isAlert:!1,containerClassName:"ms-modalExample-container"},s.createElement("div",{className:"notice notification "+this.props.courseColorClass+" reveal-modal course-announcements-slide open in"},s.createElement("h1",{className:"modal-title"},1===a?c.translate(d.resolveCourseOrgToken("announcements.newCourseAnnouncement",m)):c.translate(d.resolveCourseOrgToken("announcements.multipleCourseAnnouncements",m),{announcementsCount:a})),s.createElement("div",{className:"modal-contents"},s.createElement("ul",{className:"notifications"},s.createElement("li",{className:"element-card"},s.createElement("div",{className:"element-image"},s.createElement(l.SvgIcon,{iconName:"announcement",iconSize:"large",iconDecorative:!1,className:"element-image"})),s.createElement("div",{className:"element-details"},s.createElement("div",{className:"context"}),s.createElement("div",{className:"name"},s.createElement("span",{className:"rows-block header-title",role:"heading",title:p},p),s.createElement("span",{className:"rows-block header-sent-date"},d.displayDateTime(n.startDateRestriction,c))),s.createElement("br",null),s.createElement("div",{className:"rows-block body-text message-entries"},s.createElement("textarea",{value:h,readOnly:!0})))))),s.createElement("div",{className:"modal-footer"},!o&&s.createElement(l.PrimaryButton,{onClick:this.onClickPrevious,className:"previous-message",text:c.translate("course.announcements.button.previous"),analyticsId:"course.announcements.slide.previous.button"}),s.createElement(l.PrimaryButton,{onClick:r?this.onDismiss:this.onClickNext,className:"dismiss-message",text:r?c.translate("course.announcements.button.dismiss"):c.translate("course.announcements.button.next"),analyticsId:r?"course.announcements.slide.dismiss.button":"course.announcements.slide.next.button"}))))},t}(s.Component);t.AnnouncementSlide=h,t.default=i.connect(function(e){return{courseContext:e.announcement.courseContext}},function(e){return p.bindActionCreators({getCourseContext:m.actions.announcement.getCourseContext},e)})(c.localizedComponentWrapper(h))},"Gi+M":function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n("q1tI"),i=n("wd/R"),c=n("HIKz"),l=n("YMBy"),u=n("PcON");n("o/+e");var m=n("y9V7"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hideDialog:!0,target:null},t.timerHandler=null,t.onClickActionMenu=function(e){t.setState({target:e.currentTarget})},t.onOpenDeleteConfirmDialog=function(){t.setState({hideDialog:!1})},t.onCloseDeleteConfirmDialog=function(){t.setState({hideDialog:!0})},t.onOpenAnnouncement=function(){var e=t.props,n=e.courseId,a=e.announcement,r=e.permissions;t.props.openAnnouncementDetailPanel(n,a.id,r)},t.onPostAnnouncement=function(){var e=t.props,n=e.saveAnnouncement,a=e.courseId,r=e.announcement;n(a,o({},r,{isDraft:!1,startDateRestriction:i().toISOString(),endDateRestriction:""}))},t.onEditAnnouncement=function(){var e=t.props,n=e.courseId,a=e.announcement,r=e.permissions;t.props.openAnnouncementDetailPanel(n,a.id,r,l.default.EDIT)},t.onDuplicateAnnouncement=function(){var e=t.props,n=e.courseId,a=e.announcement,r=e.permissions;t.props.openAnnouncementDetailPanel(n,a.id,r,l.default.DUPLICATE)},t.onDeleteAnnouncement=function(){var e=t.props,n=e.removeAnnouncement,a=e.announcement,r=e.loadAnnouncements,o=e.courseId;n(a.courseId,a.id).then(function(){t.onCloseDeleteConfirmDialog(),r(o,{})})},t.isPostedAnnouncement=function(e){return!(e.isDraft||e.startDateRestriction&&i(e.startDateRestriction).isAfter(i()))},t.getActionOptions=function(e){var n=t.props,a=n.permissions,r=n.analyticsId,o=n.analyticsEventAugmentor,s={items:[]},i=o("click",t.onEditAnnouncement,r+".listItem.edit.button"),c=o("click",t.onDuplicateAnnouncement,r+".listItem.duplicate.button"),u=o("click",t.onOpenDeleteConfirmDialog,r+".listItem.delete.button");return a&&a.modify&&s.items.push({key:l.default.EDIT,name:e.translate("course.announcements.button.edit"),iconProps:{iconName:"draw",iconSize:"small"},onClick:i}),a&&a.create&&s.items.push({key:l.default.DUPLICATE,name:e.translate("course.announcements.button.duplicate"),iconProps:{iconName:"duplicate",iconSize:"small"},onClick:c}),a&&a.delete&&s.items.push({key:l.default.DELETE,name:e.translate("course.announcements.button.delete"),iconProps:{iconName:"trash",iconSize:"small"},onClick:u}),s},t.registerTimeoutEvent=function(){var e=t.props,n=e.debounceTime,a=e.onExpire,r=e.announcement;t.timerHandler=setTimeout(function(){a(r.id)},n)},t.renderDialog=function(){var e=t.props,n=e.localize,a=e.analyticsId;return s.createElement(c.Dialog,{onDismiss:function(){t.setState({hideDialog:!0})},showAsCallout:!t.state.hideDialog,target:t.state.target,dialogContentProps:{type:c.DialogType.actionConfirmation,title:n.translate("course.announcements.dialogText.deleteAnnouncement"),subText:n.translate("course.announcements.dialogText.confirmDeleteAnnouncement"),showCloseButton:!1},analyticsId:a+".listItem.deleteDialog"},s.createElement(c.DialogFooter,null,s.createElement(c.DefaultButton,{onClick:t.onCloseDeleteConfirmDialog,text:n.translate("course.announcements.button.cancel"),analyticsId:a+".listItem.deleteDialog.cancel.button"}),s.createElement(c.PrimaryButton,{onClick:t.onDeleteAnnouncement,text:n.translate("course.announcements.button.delete"),className:"deleteConfirmBtn",analyticsId:a+".listItem.deleteDialog.confirm.button"})))},t}return r(t,e),t.prototype.componentDidMount=function(){this.props.isNewlyCreated&&this.registerTimeoutEvent()},t.prototype.componentDidUpdate=function(e){!e.isNewlyCreated&&this.props.isNewlyCreated&&this.registerTimeoutEvent()},t.prototype.componentWillUnmount=function(){this.timerHandler&&clearTimeout(this.timerHandler)},t.prototype.render=function(){var e=this.props,t=e.announcement,n=e.localize,a=e.permissions,r=e.isCourseAvailable,o=e.isNewlyCreated,i=e.analyticsId,l=e.analyticsEventAugmentor,m=this.getActionOptions(n),d=l("click",this.onOpenAnnouncement,i+".listItem.open.link");return s.createElement("tr",{className:"announcement-item-row "+(o?"is-new":""),role:"row"},s.createElement("td",{className:"announcement-header-column "+(a.viewUnposted?"small-1-2":"large-1"),role:"gridcell"},s.createElement("div",{className:"announcement-header"},s.createElement("div",{className:"small-1-1 announcement-icon"+(t.isDraft?" is-restricted":"")},s.createElement(c.SvgIcon,{iconName:"announcement",iconSize:"large",iconDecorative:!0,className:"element-image"})),s.createElement("div",{className:"click-message-detail"},s.createElement("div",{className:"announcement-title-detail"},s.createElement("a",{className:"list-item-title "+(a.viewUnposted?"entitled":"")+" ",href:"#",onClick:d},u.decodeHtmlEntities(t.title)),t.isDraft&&s.createElement("span",{className:"draft-status one-line"},n.translate("course.announcements.status.draft"))),s.createElement("a",{className:"list-item-body "+(a.viewUnposted?"one-line":"three-lines multiple-line-ellipsis"),href:"#",onClick:this.onOpenAnnouncement},t.body&&u.decodeOnlyAngleBracketHtmlEntities(t.body.rawText))))),s.createElement("td",{className:"announcement-status-column",role:"gridcell"},t.isDraft&&a.modify?s.createElement(c.DefaultButton,{"data-automation-id":"test",text:n.translate("course.announcements.button.postNow"),onClick:this.onPostAnnouncement,disabled:!a.viewUnposted||!r,analyticsId:i+".listItem.postNow.button"}):s.createElement("div",null,s.createElement("span",{className:"list-item-status"},a.viewUnposted&&(t.isDraft?n.translate("course.announcements.status.draft"):this.isPostedAnnouncement(t)?n.translate("course.announcements.status.post"):n.translate("course.announcements.status.scheduled"))),s.createElement("span",{className:"list-item-date-sent"},t.startDateRestriction&&!t.isDraft&&u.displayDateTime(t.startDateRestriction,n)))),a.viewUnposted&&s.createElement("td",{className:"announcement-viewers-column",role:"gridcell"},s.createElement("div",{className:"announcement-viewers",onClick:this.onClickActionMenu},s.createElement("span",{className:"list-item-view-count"},t.readCount||0," / ",t.totalParticipants),m&&m.items&&m.items.length>0&&s.createElement(c.ActionMenu,{ariaLabel:""+n.translate("course.announcements.moreOptions",{announcementTitle:t.title}),disabled:!this.state.hideDialog,menuProps:m,maintainExpandedProperties:!this.state.hideDialog,analyticsId:i+".listItem.actionMenu"}),this.renderDialog())))},t}(s.Component);t.AnnouncementListItem=d,t.default=m.withAnalytics(d)},LwTs:function(e,t,n){},PcON:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("wd/R"),r=n("hTOW"),o=864e5,s="components.directives.duration.agoText";t.displayDateTime=function(e,t){var n="";if(e&&a(e).isValid()){var i=a(e).toDate();if(function(e,t,n){return e>=t&&e<n}((new Date).getTime()-i.getTime(),0,o)){var c=t.formatDuration(i,{},r.ILocaleDateFormat.Short);n=t.translate(s,{durationDate:c.date||"",durationTime:c.time||""})}else n=t.formatDatetime(i,r.ILocaleDatetimeFormat.Short)}return n};var i=document.createElement("textarea");t.decodeHtmlEntities=function(e){return i.innerHTML=e,i.value},t.decodeOnlyAngleBracketHtmlEntities=function(e){return null==e?e:e.replace(/&gt;/g,">").replace(/&lt;/g,"<")},t.encodeHtmlEntities=function(e){return null==e?e:e.replace(/[\u00A0-\u9999<>\&]/gim,function(e){return"&#"+e.charCodeAt(0)+";"})},t.buildDateTimeMoment=function(e,t){var n=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds());return a(n)},t.resolveCourseOrgToken=function(e,t){return(t&&t.isOrganization?"organization.":"course.")+e}},QY22:function(e,t,n){var a,r,o;r=[n("q1tI"),n("17x9")],void 0===(o="function"==typeof(a=function(t,n){"use strict";var a,r,o;function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function m(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t=function(e){if(e&&e.__esModule)return e;var t=s();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=a?Object.getOwnPropertyDescriptor(e,r):null;o&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r]}}return n.default=e,t&&t.set(e,n),n}(t),n=(o=n)&&o.__esModule?o:{default:o};var f={x:"clientWidth",y:"clientHeight"},v={x:"clientTop",y:"clientLeft"},S={x:"innerWidth",y:"innerHeight"},g={x:"offsetWidth",y:"offsetHeight"},y={x:"offsetLeft",y:"offsetTop"},C={x:"overflowX",y:"overflowY"},E={x:"scrollWidth",y:"scrollHeight"},b={x:"scrollLeft",y:"scrollTop"},P={x:"width",y:"height"},D=function(){},I=!!function(){if("undefined"==typeof window)return!1;var e=!1;try{document.createElement("div").addEventListener("test",D,{get passive(){return e=!0,!1}})}catch(e){}return e}()&&{passive:!0},w=function(e,t){var n=e.length,a=e.minSize,r=e.type,o=t.from,s=t.size,i=t.itemsPerRow,c=(s=Math.max(s,a))%i;return c&&(s+=i-c),s>n&&(s=n),o="simple"!==r&&o?Math.max(Math.min(o,n-s),0):0,(c=o%i)&&(o-=c,s+=c),o===t.from&&s==t.size?t:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(n,!0).forEach(function(t){h(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t,{from:o,size:s})};e.exports=(r=a=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=c(this,l(n).call(this,e))).state=w(e,{itemsPerRow:1,from:e.initialIndex,size:0}),t.cache={},t.cachedScrollPosition=null,t.prevPrevState={},t.unstable=!1,t.updateCounter=0,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(n,e),m(n,null,[{key:"getDerivedStateFromProps",value:function(e,t){var n=w(e,t);return n===t?null:n}}]),m(n,[{key:"componentDidMount",value:function(){this.updateFrameAndClearCache=this.updateFrameAndClearCache.bind(this),window.addEventListener("resize",this.updateFrameAndClearCache),this.updateFrame(this.scrollTo.bind(this,this.props.initialIndex))}},{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.axis!==e.axis&&this.clearSizeCache(),!this.unstable){if(++this.updateCounter>50)return this.unstable=!0,console.error("ReactList failed to reach a stable state.");this.updateCounterTimeoutId||(this.updateCounterTimeoutId=setTimeout(function(){t.updateCounter=0,delete t.updateCounterTimeoutId},0)),this.updateFrame()}}},{key:"maybeSetState",value:function(e,t){if(function(e,t){for(var n in t)if(e[n]!==t[n])return!1;return!0}(this.state,e))return t();this.setState(e,t)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateFrameAndClearCache),this.scrollParent.removeEventListener("scroll",this.updateFrameAndClearCache,I),this.scrollParent.removeEventListener("mousewheel",D,I)}},{key:"getOffset",value:function(e){var t=this.props.axis,n=e[v[t]]||0,a=y[t];do{n+=e[a]||0}while(e=e.offsetParent);return n}},{key:"getEl",value:function(){return this.el||this.items}},{key:"getScrollPosition",value:function(){if("number"==typeof this.cachedScrollPosition)return this.cachedScrollPosition;var e=this.scrollParent,t=this.props.axis,n=b[t],a=e===window?document.body[n]||document.documentElement[n]:e[n],r=this.getScrollSize()-this.props.scrollParentViewportSizeGetter(this),o=Math.max(0,Math.min(a,r)),s=this.getEl();return this.cachedScrollPosition=this.getOffset(e)+o-this.getOffset(s),this.cachedScrollPosition}},{key:"setScroll",value:function(e){var t=this.scrollParent,n=this.props.axis;if(e+=this.getOffset(this.getEl()),t===window)return window.scrollTo(0,e);e-=this.getOffset(this.scrollParent),t[b[n]]=e}},{key:"getScrollSize",value:function(){var e=this.scrollParent,t=document,n=t.body,a=t.documentElement,r=E[this.props.axis];return e===window?Math.max(n[r],a[r]):e[r]}},{key:"hasDeterminateSize",value:function(){var e=this.props,t=e.itemSizeGetter,n=e.type;return"uniform"===n||t}},{key:"getStartAndEnd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.threshold,t=this.getScrollPosition(),n=Math.max(0,t-e),a=t+this.props.scrollParentViewportSizeGetter(this)+e;return this.hasDeterminateSize()&&(a=Math.min(a,this.getSpaceBefore(this.props.length))),{start:n,end:a}}},{key:"getItemSizeAndItemsPerRow",value:function(){var e=this.props,t=e.axis,n=e.useStaticSize,a=this.state,r=a.itemSize,o=a.itemsPerRow;if(n&&r&&o)return{itemSize:r,itemsPerRow:o};var s=this.items.children;if(!s.length)return{};var i=s[0],c=i[g[t]],l=Math.abs(c-r);if((isNaN(l)||l>=1)&&(r=c),!r)return{};for(var u=y[t],m=i[u],d=s[o=1];d&&d[u]===m;d=s[o])++o;return{itemSize:r,itemsPerRow:o}}},{key:"clearSizeCache",value:function(){this.cachedScrollPosition=null}},{key:"updateFrameAndClearCache",value:function(e){return this.clearSizeCache(),this.updateFrame(e)}},{key:"updateFrame",value:function(e){switch(this.updateScrollParent(),"function"!=typeof e&&(e=D),this.props.type){case"simple":return this.updateSimpleFrame(e);case"variable":return this.updateVariableFrame(e);case"uniform":return this.updateUniformFrame(e)}}},{key:"updateScrollParent",value:function(){var e=this.scrollParent;this.scrollParent=this.props.scrollParentGetter(this),e!==this.scrollParent&&(e&&(e.removeEventListener("scroll",this.updateFrameAndClearCache),e.removeEventListener("mousewheel",D)),this.clearSizeCache(),this.scrollParent.addEventListener("scroll",this.updateFrameAndClearCache,I),this.scrollParent.addEventListener("mousewheel",D,I))}},{key:"updateSimpleFrame",value:function(e){var t=this.getStartAndEnd(),n=t.end,a=this.items.children,r=0;if(a.length){var o=this.props.axis,s=a[0],i=a[a.length-1];r=this.getOffset(i)+i[g[o]]-this.getOffset(s)}if(r>n)return e();var c=this.props,l=c.pageSize,u=c.length,m=Math.min(this.state.size+l,u);this.maybeSetState({size:m},e)}},{key:"updateVariableFrame",value:function(e){this.props.itemSizeGetter||this.cacheSizes();for(var t=this.getStartAndEnd(),n=t.start,a=t.end,r=this.props,o=r.length,s=r.pageSize,i=0,c=0,l=0,u=o-1;c<u;){var m=this.getSizeOfItem(c);if(null==m||i+m>n)break;i+=m,++c}for(var d=o-c;l<d&&i<a;){var p=this.getSizeOfItem(c+l);if(null==p){l=Math.min(l+s,d);break}i+=p,++l}this.maybeSetState({from:c,size:l},e)}},{key:"updateUniformFrame",value:function(e){var t=this.getItemSizeAndItemsPerRow(),n=t.itemSize,a=t.itemsPerRow;if(!n||!a)return e();var r=this.getStartAndEnd(),o=r.start,s=r.end,i=w(this.props,{from:Math.floor(o/n)*a,size:(Math.ceil((s-o)/n)+1)*a,itemsPerRow:a}),c=i.from,l=i.size;return this.maybeSetState({itemsPerRow:a,from:c,itemSize:n,size:l},e)}},{key:"getSpaceBefore",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!=t[e])return t[e];var n=this.state,a=n.itemSize,r=n.itemsPerRow;if(a)return t[e]=Math.floor(e/r)*a;for(var o=e;o>0&&null==t[--o];);for(var s=t[o]||0,i=o;i<e;++i){t[i]=s;var c=this.getSizeOfItem(i);if(null==c)break;s+=c}return t[e]=s}},{key:"cacheSizes",value:function(){for(var e=this.cache,t=this.state.from,n=this.items.children,a=g[this.props.axis],r=0,o=n.length;r<o;++r)e[t+r]=n[r][a]}},{key:"getSizeOfItem",value:function(e){var t=this.cache,n=this.items,a=this.props,r=a.axis,o=a.itemSizeGetter,s=a.itemSizeEstimator,i=a.type,c=this.state,l=c.from,u=c.itemSize,m=c.size;if(u)return u;if(o)return o(e);if(e in t)return t[e];if("simple"===i&&e>=l&&e<l+m&&n){var d=n.children[e-l];if(d)return d[g[r]]}return s?s(e,t):void 0}},{key:"scrollTo",value:function(e){null!=e&&this.setScroll(this.getSpaceBefore(e))}},{key:"scrollAround",value:function(e){var t=this.getScrollPosition(),n=this.getSpaceBefore(e),a=n-this.props.scrollParentViewportSizeGetter(this)+this.getSizeOfItem(e),r=Math.min(a,n),o=Math.max(a,n);return t<=r?this.setScroll(r):t>o?this.setScroll(o):void 0}},{key:"getVisibleRange",value:function(){for(var e,t,n=this.state,a=n.from,r=n.size,o=this.getStartAndEnd(0),s=o.start,i=o.end,c={},l=a;l<a+r;++l){var u=this.getSpaceBefore(l,c),m=u+this.getSizeOfItem(l);null==e&&m>s&&(e=l),null!=e&&u<i&&(t=l)}return[e,t]}},{key:"renderItems",value:function(){for(var e=this,t=this.props,n=t.itemRenderer,a=t.itemsRenderer,r=this.state,o=r.from,s=r.size,i=[],c=0;c<s;++c)i.push(n(o+c,c));return a(i,function(t){return e.items=t})}},{key:"render",value:function(){var e=this,n=this.props,a=n.axis,r=n.length,o=n.type,s=n.useTranslate3d,i=this.state,c=i.from,l=i.itemsPerRow,u=this.renderItems();if("simple"===o)return u;var m={position:"relative"},d={},p=Math.ceil(r/l)*l,h=this.getSpaceBefore(p,d);h&&(m[P[a]]=h,"x"===a&&(m.overflowX="hidden"));var f=this.getSpaceBefore(c,d),v="x"===a?f:0,S="y"===a?f:0,g=s?"translate3d(".concat(v,"px, ").concat(S,"px, 0)"):"translate(".concat(v,"px, ").concat(S,"px)"),y={msTransform:g,WebkitTransform:g,transform:g};return t.default.createElement("div",{style:m,ref:function(t){return e.el=t}},t.default.createElement("div",{style:y},u))}}]),n}(t.Component),h(a,"displayName","ReactList"),h(a,"propTypes",{axis:n.default.oneOf(["x","y"]),initialIndex:n.default.number,itemRenderer:n.default.func,itemSizeEstimator:n.default.func,itemSizeGetter:n.default.func,itemsRenderer:n.default.func,length:n.default.number,minSize:n.default.number,pageSize:n.default.number,scrollParentGetter:n.default.func,scrollParentViewportSizeGetter:n.default.func,threshold:n.default.number,type:n.default.oneOf(["simple","variable","uniform"]),useStaticSize:n.default.bool,useTranslate3d:n.default.bool}),h(a,"defaultProps",{axis:"y",itemRenderer:function(e,n){return t.default.createElement("div",{key:n},e)},itemsRenderer:function(e,n){return t.default.createElement("div",{ref:n},e)},length:0,minSize:1,pageSize:10,scrollParentGetter:function(e){for(var t=e.props.axis,n=e.getEl(),a=C[t];n=n.parentElement;)switch(window.getComputedStyle(n)[a]){case"auto":case"scroll":case"overlay":return n}return window},scrollParentViewportSizeGetter:function(e){var t=e.props.axis,n=e.scrollParent;return n===window?window[S[t]]:n[f[t]]},threshold:100,type:"simple",useStaticSize:!1,useTranslate3d:!1}),r)})?a.apply(t,r):a)||(e.exports=o)},YMBy:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.VIEW=new t("view"),t.CREATE=new t("create"),t.EDIT=new t("edit"),t.DUPLICATE=new t("duplicate"),t.DELETE=new t("delete"),t}(n("oSB+").default);t.default=o},Zb9l:function(e,t,n){},a99v:function(e,t,n){},"jsc/":function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n("q1tI"),s=n("z1U9"),i=n("y9V7");n("Zb9l"),t.ICON_CHEVRON_UP="arrow-up",t.ICON_CHEVRON_DOWN="arrow-down";var c=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.getArrowDirection=function(){var e=n.props,a=e.currentSort,r=e.sortCriteria;return r&&r.includes(a)?(n.localSort=a,n.isDescendingSort(a)?t.ICON_CHEVRON_DOWN:t.ICON_CHEVRON_UP):""},n.updateSortCriteria=function(){var e=n.props,t=e.sortCriteria,a=e.onSwitchSortCriteria;n.localSort?n.localSort=t[0===t.indexOf(n.localSort)?t.length-1:0]:n.localSort=t[0],a(n.localSort)},n.isDescendingSort=function(e){return e===s.SortCriteriaEnum.DATE_DESC||e===s.SortCriteriaEnum.STATUS_DESC||e===s.SortCriteriaEnum.VIEWS_DESC||e===s.SortCriteriaEnum.TITLE_DESC},n}return r(n,e),n.prototype.render=function(){var e=this,n=this.props,a=n.localize,r=n.sortCriteria,s=n.viewText,i=n.analyticsId,c=(0,n.analyticsEventAugmentor)("click",this.updateSortCriteria,i);return o.createElement(o.Fragment,null,o.createElement("button",{id:"sort-by-"+s+"-button",className:"active clear","aria-describedby":"sort-by-"+s,onClick:c},o.createElement("span",{className:"sort-description"},a.translate("course.announcements.sort."+s+".description")),o.createElement("div",{className:"sort-list-arrows "+this.getArrowDirection(),role:"presentation"},r&&r.length>0&&r.map(function(t,n){return o.createElement("div",{className:e.isDescendingSort(t)?"sort-list-arrow-down":"sort-list-arrow-up",key:n})}))),o.createElement("span",{id:"sort-by-"+s,className:"sr-only","aria-live":"assertive"},this.getArrowDirection()?this.getArrowDirection()===t.ICON_CHEVRON_UP?a.translate("course.announcements.sort."+s+".asc"):a.translate("course.announcements.sort."+s+".desc"):""))},n}(o.PureComponent);t.SortControl=c,t.default=i.withAnalytics(c)},nPfc:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n("q1tI"),s=n("wd/R"),i=n("HIKz"),c=n("hTOW"),l=n("y9V7");n("/ObN");var u={pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,esc:27,enter:13},m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={timeStr:"",hour:"",minute:"",amPm:"",isDisplaySpinner:!1,tzShort:""},t.timeoutPromiseWrapper=function(e,n,a){return new Promise(function(r){e.apply(t,n),setTimeout(function(){var t=e.apply(a,n);r(t)})})},t.errorMessage=function(){var e=t.props,n=e.isValueValid,a=e.errorEmptyMessage,r=e.errorFormatMessage;if(n)return null;var s=r;return t.state.timeStr||(s=a),o.createElement("span",{className:"error-message"},o.createElement(i.SvgIcon,{iconSize:"small",iconName:"attention"}),s)},t.updateSpinnerInputs=function(e){var n=t.props.localize;t.timeoutPromiseWrapper(n.getTimeObject,[e,c.ILocaleTimeFormat.Short],n).then(function(e){t.setState({hour:e.hour,minute:e.minute,amPm:e.amPm?e.amPm.toUpperCase():""})})},t.updateTimeInput=function(e){var n=t.props,a=n.localize,r=n.onValidateCallback;t.timeoutPromiseWrapper(a.formatTime,[e,c.ILocaleTimeFormat.Short],a).then(function(e){t.setState({timeStr:e}),r(!0)})},t.adjustTime=function(e,t,n,a){var r=parseInt(e,10);return isNaN(r)?t:r>=n&&r<=a?e:r<n?n.toString():a.toString()},t.closeSpinner=function(){t.setState({isDisplaySpinner:!1})},t.stopEvents=function(e){e.stopPropagation();var t=e.which;t!==u.up&&t!==u.down&&t!==u.home&&t!==u.end&&t!==u.left&&t!==u.right&&t!==u.pageup&&t!==u.pagedown||e.preventDefault()},t.isValidDate=function(e){return e instanceof Date&&!isNaN(e.valueOf())},t.onToggleSpinner=function(){t.setState({isDisplaySpinner:!t.state.isDisplaySpinner})},t.onChangeTimeInput=function(e){var n=e.target.value;t.setState({timeStr:n}),e.persist();var a=t.props,r=a.onValidateCallback,o=a.localize;t.timeoutPromiseWrapper(o.parseTime,[n,c.ILocaleTimeFormat.Short],o).then(function(e){e?(r(!0),t.tempDate=new Date(e),t.updateSpinnerInputs(t.tempDate)):r(!1)})},t.onHourInputChange=function(e){var n=t.state.amPm?1:0,a=t.state.amPm?12:23,r=e.target.value;r.length<=2&&t.setState({hour:r},function(){r=t.adjustTime(r,t.state.hour,n,a);var e=new Date(t.props.value);e.setHours(parseInt(r,10)),t.isValidDate(e)&&(t.tempDate=e,t.updateTimeInput(e))})},t.onMinuteInputChange=function(e){var n=e.target.value;n.length<=2&&t.setState({minute:n},function(){n=t.adjustTime(n,t.state.minute,0,59);var e=new Date(t.props.value);e.setMinutes(parseInt(n,10)),t.isValidDate(e)&&(t.tempDate=e,t.updateTimeInput(e))})},t.onChangeAmPmInput=function(e){var n=e.target.value.toUpperCase();n.length<=2&&(e.persist(),t.setState({amPm:n},function(){var e=t.props.localize,a=t.state.timeStr.split(" ")[0]+" "+n;t.timeoutPromiseWrapper(e.parseTime,[a,c.ILocaleTimeFormat.Short],e).then(function(e){e&&(t.tempDate=new Date(e),t.updateTimeInput(t.tempDate))})}))},t.onHandlerBlur=function(){t.props.isValueValid&&t.props.onChangeValue(t.tempDate),t.tempDate.getTime()===t.props.value.getTime()&&t.updateSpinnerInputs(t.tempDate),setTimeout(function(){t.timePickerRef.contains(document.activeElement)||t.closeSpinner()})},t.onClickChangeButton=function(e,n){t.tempDate=s(t.props.value).add(n,e).toDate(),t.props.onChangeValue(t.tempDate)},t.onKeyupInInput=function(e,n){var a=t.props.onChangeValue;switch(t.stopEvents(e),e.which){case u.esc:t.closeSpinner();break;case u.right:case u.up:a(s(t.tempDate).add(1,n).toDate());break;case u.left:case u.down:a(s(t.tempDate).add(-1,n).toDate());break;case u.pageup:"h"===n?a(s(t.tempDate).add(3,n).toDate()):"m"===n&&a(s(t.tempDate).add(10,n).toDate());break;case u.pagedown:"h"===n?a(s(t.tempDate).add(-3,n).toDate()):"m"===n&&a(s(t.tempDate).add(-10,n).toDate());break;case u.home:"h"===n?a(s(t.tempDate).hour(t.state.amPm?12:23).toDate()):"m"===n&&a(s(t.tempDate).minute(59).toDate());break;case u.end:"h"===n?a(s(t.tempDate).hour(t.state.amPm?1:0).toDate()):"m"===n&&a(s(t.tempDate).minute(0).toDate())}},t.onKeyupInAmPmInput=function(e){t.stopEvents(e);var n=e.which;n===u.esc?t.closeSpinner():n!==u.up&&n!==u.down&&n!==u.home&&n!==u.end&&n!==u.left&&n!==u.right&&n!==u.pageup&&n!==u.pagedown||t.props.onChangeValue(s(t.tempDate).add(12,"h").toDate())},t.onKeyupInChangeButton=function(e){t.stopEvents(e),e.which===u.esc&&t.closeSpinner()},t.onStopDefaultEvent=function(e){t.stopEvents(e)},t.onTimeInputKeyPress=function(e){e.which===u.enter&&t.closeSpinner()},t.onFocusInput=function(e){e.target.select()},t}return r(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.localize,a=t.value,r=t.onValidateCallback,o=new Date;if(this.timeoutPromiseWrapper(n.formatTimezone,[o,c.ILocaleTimezoneFormat.Short],n).then(function(t){e.setState({tzShort:t})}),a&&!this.state.timeStr){this.tempDate=a;var s=this.timeoutPromiseWrapper(n.formatTime,[a,c.ILocaleTimeFormat.Short],n),i=this.timeoutPromiseWrapper(n.getTimeObject,[a,c.ILocaleTimeFormat.Short],n);Promise.all([s,i]).then(function(t){var n=t[0],a=t[1];e.setState({timeStr:n,hour:a.hour,minute:a.minute,amPm:a.amPm?a.amPm.toUpperCase():""}),r(!0)})}},t.prototype.componentDidUpdate=function(e,t){var n=this,a=this.props,r=a.localize,o=a.value,s=a.onValidateCallback;if(o&&(o&&o.getTime())!==(e.value&&e.value.getTime())){this.tempDate=o;var i=this.timeoutPromiseWrapper(r.formatTime,[o,c.ILocaleTimeFormat.Short],r),l=this.timeoutPromiseWrapper(r.getTimeObject,[o,c.ILocaleTimeFormat.Short],r);Promise.all([i,l]).then(function(e){var t=e[0],a=e[1];n.setState({timeStr:t,hour:a.hour,minute:a.minute,amPm:a.amPm?a.amPm.toUpperCase():""}),s(!0)})}var u=this.state.isDisplaySpinner;t.isDisplaySpinner!==u&&u&&this.hourInputRef.focus()},t.prototype.render=function(){var e=this,t=this.state,n=t.timeStr,a=t.hour,r=t.minute,s=t.isDisplaySpinner,c=t.tzShort,l=t.amPm,u=this.props,m=(u.isValueValid,u.disabled),d=(u.errorFormatMessage,u.localize),p=u.analyticsId,h=u.analyticsEventAugmentor,f="spinner-control "+(l?"":"no-am-pm"),v=h("click",function(){},p+".input.text"),S=h("click",function(){},p+".hour.input.text"),g=h("click",function(){},p+".minute.input.text"),y=h("click",function(){},p+".amPm.input.text");return o.createElement("div",{className:"time-picker",ref:function(t){return e.timePickerRef=t},onBlur:this.onHandlerBlur},o.createElement("div",{className:"calendar-input-container"},o.createElement("input",{type:"text",className:"time-input",value:n,onChange:this.onChangeTimeInput,ref:function(t){return e.timeInputRef=t},disabled:m,onKeyPress:this.onTimeInputKeyPress,onClick:v}),o.createElement(i.IconButton,{ariaLabel:d.translate("course.announcements.timePicker.dueDate"),className:"btn-date open-datepicker toggle-btn",disabled:m,iconProps:{iconName:"away",iconSize:"small"},onClick:this.onToggleSpinner,title:d.translate("course.announcements.timePicker.dueDate"),analyticsId:p+".open.button"}),this.errorMessage()),s&&o.createElement(i.Callout,{target:this.timeInputRef,doNotLayer:!0,directionalHint:5},o.createElement("div",{className:f,"aria-hidden":!s,role:"region","aria-label":"Due Date Time",tabIndex:-1},o.createElement("div",{className:"spinner-hour"},o.createElement(i.IconButton,{ariaLabel:d.translate("course.announcements.timePicker.increaseHour"),className:"button-hour add-hour-btn",iconProps:{iconName:"arrow-up",iconSize:"small"},onKeyUp:this.onKeyupInChangeButton,onClick:function(){e.onClickChangeButton("h",1)},onKeyDown:this.onStopDefaultEvent,title:d.translate("course.announcements.timePicker.increaseHour"),analyticsId:p+".increaseHour.button"}),o.createElement("input",{type:"text",className:"spinner-input hour-input",ref:function(t){return e.hourInputRef=t},"aria-label":d.translate("course.announcements.timePicker.hour"),value:a,role:"spinbutton","aria-valuenow":parseInt(a,10),"aria-valuemax":l?12:23,"aria-valuemin":l?1:0,onChange:this.onHourInputChange,onFocus:this.onFocusInput,onKeyUp:function(t){return e.onKeyupInInput(t,"h")},onKeyDown:this.onStopDefaultEvent,onKeyPress:this.onTimeInputKeyPress,onClick:S}),o.createElement(i.IconButton,{ariaLabel:d.translate("course.announcements.timePicker.decreaseHour"),className:"button-hour sub-hour-btn",iconProps:{iconName:"arrow-down",iconSize:"small"},onClick:function(){e.onClickChangeButton("h",-1)},onKeyUp:this.onKeyupInChangeButton,onKeyDown:this.onStopDefaultEvent,title:d.translate("course.announcements.timePicker.decreaseHour"),analyticsId:p+".decreaseHour.button"})),o.createElement("div",{className:"colon"},":"),o.createElement("div",{className:"spinner-min"},o.createElement(i.IconButton,{ariaLabel:d.translate("course.announcements.timePicker.increaseMinute"),className:"button-minute add-min-btn",iconProps:{iconName:"arrow-up",iconSize:"small"},onClick:function(){e.onClickChangeButton("m",1)},onKeyUp:this.onKeyupInChangeButton,onKeyDown:this.onStopDefaultEvent,title:d.translate("course.announcements.timePicker.increaseMinute"),analyticsId:p+".increaseMinute.button"}),o.createElement("input",{type:"text",className:"spinner-input min-input","aria-label":d.translate("course.announcements.timePicker.minute"),value:r,role:"spinbutton","aria-valuenow":parseInt(r,10),"aria-valuemax":59,"aria-valuemin":0,onChange:this.onMinuteInputChange,onFocus:this.onFocusInput,onKeyUp:function(t){return e.onKeyupInInput(t,"m")},onKeyDown:this.onStopDefaultEvent,onKeyPress:this.onTimeInputKeyPress,onClick:g}),o.createElement(i.IconButton,{ariaLabel:d.translate("course.announcements.timePicker.decreaseMinute"),className:"button-minute sub-min-btn",iconProps:{iconName:"arrow-down",iconSize:"small"},onClick:function(){e.onClickChangeButton("m",-1)},onKeyUp:this.onKeyupInChangeButton,onKeyDown:this.onStopDefaultEvent,title:d.translate("course.announcements.timePicker.decreaseMinute"),analyticsId:p+".decreaseMinute.button"})),o.createElement("div",null,o.createElement("div",{className:"spinner-ampm"},o.createElement(i.IconButton,{ariaLabel:d.translate("course.announcements.timePicker.changeToAmPm"),className:"button-change-ampm add-am-pm-btn",iconProps:{iconName:"arrow-up",iconSize:"small"},onClick:function(){e.onClickChangeButton("h",12)},onKeyUp:this.onKeyupInChangeButton,onKeyDown:this.onStopDefaultEvent,title:d.translate("course.announcements.timePicker.changeToAmPm"),analyticsId:p+".changeAmPm.button"}),o.createElement("input",{type:"text",className:"spinner-input am-pm-input","aria-label":d.translate("course.announcements.timePicker.amPm"),value:l,role:"spinbutton",onChange:this.onChangeAmPmInput,onFocus:this.onFocusInput,onKeyUp:this.onKeyupInAmPmInput,onKeyDown:this.onStopDefaultEvent,onKeyPress:this.onTimeInputKeyPress,onClick:y}),o.createElement(i.IconButton,{ariaLabel:d.translate("course.announcements.timePicker.changeToAmPm"),className:"button-change-ampm sub-am-pm-btn",iconProps:{iconName:"arrow-down",iconSize:"small"},onClick:function(){e.onClickChangeButton("h",12)},onKeyUp:this.onKeyupInChangeButton,onKeyDown:this.onStopDefaultEvent,title:d.translate("course.announcements.timePicker.changeToAmPm"),analyticsId:p+".changeAmPm.button"})))),o.createElement("hr",null),o.createElement("div",{className:"tz-offset"},o.createElement("span",null,c))))},t}(o.PureComponent);t.TimePicker=m,t.default=l.withAnalytics(m)},"o/+e":function(e,t,n){},opNB:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n("q1tI"),s=n("/MKj"),i=n("QY22"),c=n("HIKz"),l=n("J8LU"),u=n("Gi+M"),m=n("18SX"),d=n("jsc/"),p=n("YMBy"),h=n("PcON");n("701c");var f=n("z1U9"),v=n("ANjH"),S=2;t.ANNOUNCEMENT_LIMIT=10;var g=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.renderAnnouncementItem=function(e){var t=n.props,a=t.courseId,r=(t.getAnnouncementsCounts,t.courseContext),s=t.localize,i=t.openAnnouncementDetailPanel,c=t.permissions,l=t.removeAnnouncement,m=t.saveAnnouncement,d=t.recentUpdatedAnnouncementIds,p=t.removeFromRecentUpdated,h=Object.values(n.props.announcements)[e];return o.createElement(u.default,{announcement:h,courseId:a,debounceTime:2e3,isCourseAvailable:r.isAvailable,isNewlyCreated:d&&d.indexOf(h.id)>-1,localize:s,key:h.id,onExpire:p,openAnnouncementDetailPanel:i,permissions:c,removeAnnouncement:l,saveAnnouncement:m,loadAnnouncements:n.loadAnnByCurrentSettings,analyticsId:"course.announcements.listPanel"})},n.onScroll=function(){if(n.list){var e=n.props,t=e.announcements,a=e.paging,r=e.loadAnnouncements,o=e.courseId,s=e.searchInputState,i=e.sortCriteria,c=s.searchText,l=Object.keys(t).length;n.list.getVisibleRange()[1]>=l-1&&l<a.count&&r(o,{offset:l,searchText:c,sort:i},!0)}},n.searchInputStateChange=function(e,t,a){var r=n.props,o=r.searchInputState,s=r.changeSearchInputState;t&&t!==o.isCollapsed?n.onToggleSearchInput():e===o.searchText&&t===o.isCollapsed&&a===o.isValidSearch||s({searchText:e,isCollapsed:t,isValidSearch:a})},n.onToggleSearchInput=function(){var e=n.props,t=e.courseId,a=e.searchInputState,r=e.changeSearchInputState,o=!a.isCollapsed,s=o?"":a.searchText;r({searchText:s,isCollapsed:o}),o&&a.searchText.trim().length>0&&n.loadAnnByCurrentSettings(t,{searchText:s})},n.onSwitchSortCriteria=function(e){var t=n.props,a=t.courseId;(0,t.switchSortCriteria)(e),n.loadAnnByCurrentSettings(a,{sort:e})},n.onCreateAnnouncement=function(){n.props.openAnnouncementDetailPanel(n.props.courseId,null,n.props.permissions,p.default.CREATE)},n.loadAnnByCurrentSettings=function(e,a){var r=n.props,o=r.announcements,s=r.searchInputState,i=r.loadAnnouncements,c=r.sortCriteria,l=a||{},u=null!=l.searchText?l.searchText:!s.isCollapsed&&s.searchText.trim()||"",m=l.sort||c,d=o&&Object.keys(o).length||0;i(e,{searchText:u,limit:l.limit||Math.max(d,t.ANNOUNCEMENT_LIMIT),offset:l.offset||0,sort:m})},n.renderNoResultString=function(e){var t=n.props,a=t.searchInputState,r=t.localize,s=t.isLoading,i=t.paging,c=t.isSearchingSuccessful,l=t.courseContext;return a.searchText?e?o.createElement("p",{className:"search-insufficient","aria-live":"assertive"},r.translate("course.announcements.characterInsufficient")):c&&o.createElement("p",{className:"search-no-results ng-scope","aria-live":"assertive"},r.translate("course.announcements.noSearchResult")):!s&&0===i.count&&a.isCollapsed&&o.createElement("p",{className:"search-no-results ng-scope"},r.translate(h.resolveCourseOrgToken("announcements.noResult",l)))},n.renderAnnouncementListView=function(e){var t=n.props,a=t.localize,r=t.searchInputState,s=t.sortCriteria,c=t.isSearchingSuccessful,l=t.permissions,u=t.courseContext,m=r.searchText.trim(),p=!r.isCollapsed&&m.length&&m.length<S&&!r.isValidSearch;return e>0&&!p?o.createElement("div",{className:"tabular-list-container"},o.createElement("div",{className:"tabular-list"},o.createElement("table",{className:"table-content sortable-table",role:"grid","aria-readonly":!0,"aria-labelledby":"announcement-table-caption"},o.createElement("caption",{id:"announcement-table-caption",className:"sr-only"},a.translate(h.resolveCourseOrgToken("announcements.pageTitle",u))),o.createElement("thead",{className:"list-item-columns announcement-sort-header"},o.createElement("tr",{className:"list-item-row announcement-sort-row",role:"row"},o.createElement("th",{className:"column-title sort",role:"columnheader",id:"title"},o.createElement(d.default,{courseId:n.props.courseId,currentSort:s,localize:a,onSwitchSortCriteria:n.onSwitchSortCriteria,sortCriteria:[f.SortCriteriaEnum.TITLE_ASC,f.SortCriteriaEnum.TITLE_DESC],viewText:"title",analyticsId:"course.announcements.listPanel.sortByTitle.button"})),o.createElement("th",{className:"column-"+(l.viewUnposted?"status":"date")+" sort",role:"columnheader",id:l.viewUnposted?"status":"date"},o.createElement(d.default,{courseId:n.props.courseId,currentSort:s,localize:a,onSwitchSortCriteria:n.onSwitchSortCriteria,sortCriteria:l.viewUnposted?[f.SortCriteriaEnum.STATUS_ASC,f.SortCriteriaEnum.STATUS_DESC]:[f.SortCriteriaEnum.DATE_ASC,f.SortCriteriaEnum.DATE_DESC],viewText:n.props.localize.translate(l.viewUnposted?"status":"date"),analyticsId:"course.announcements.listPanel.sortByDate.button"})),l.viewUnposted&&o.createElement("th",{className:"column-viewers sort",role:"columnheader",id:"viewers"},o.createElement(d.default,{courseId:n.props.courseId,currentSort:s,localize:a,onSwitchSortCriteria:n.onSwitchSortCriteria,sortCriteria:[f.SortCriteriaEnum.VIEWS_ASC,f.SortCriteriaEnum.VIEWS_DESC],viewText:"viewers",analyticsId:"course.announcements.listPanel.sortByViews.button"})))),o.createElement(i,{itemsRenderer:function(e,t){return o.createElement("tbody",{ref:t},e)},length:Object.values(n.props.announcements).length,itemRenderer:n.renderAnnouncementItem,ref:function(e){return n.list=e}}),r.isValidSearch&&c&&o.createElement("div",{"aria-live":"polite","aria-hidden":!1,className:"sr-only",role:"status"},a.translate("course.announcements.searchResults"))))):o.createElement("div",{className:"columns small-12 no-result-section"},o.createElement("div",{className:"row"},o.createElement("div",{className:"columns small-12 small-centered text-center ftue-container"},n.renderNoResultString(p))))},n}return r(n,e),n.prototype.componentDidMount=function(){var e=this.props,t=e.courseId,n=e.courseContext,a=e.getAnnouncementsCounts,r=e.getCourseContext,o=e.permissions,s=e.root,i=e.switchSortCriteria,c=o.viewUnposted?f.SortCriteriaEnum.MODIFIED_DATE_DESC:f.SortCriteriaEnum.DATE_DESC;i(c),this.loadAnnByCurrentSettings(t,{sort:c}),a(t),n&&n.courseId===t||r(t),(s&&s.querySelector(".panel-wrap")||window).addEventListener("scroll",this.onScroll),(s&&s.querySelector(".panel-wrap")||window).addEventListener("touchmove",this.onScroll)},n.prototype.componentDidUpdate=function(e){this.props.listener.refreshAnnouncementsCounts&&!e.listener.refreshAnnouncementsCounts&&this.props.getAnnouncementsCounts(this.props.courseId),this.props.listener.resetSortSetting&&!e.listener.resetSortSetting&&this.props.switchSortCriteria(f.SortCriteriaEnum.MODIFIED_DATE_DESC),this.props.listener.resetSearchSetting&&!e.listener.resetSearchSetting&&this.props.changeSearchInputState({searchText:"",isCollapsed:!0}),this.props.listener.refreshAnnouncements&&!e.listener.refreshAnnouncements&&this.props.loadAnnouncements(this.props.courseId,{searchText:this.props.searchInputState.searchText})},n.prototype.componentWillUnmount=function(){var e=this.props,t=e.root,n=e.clearAnnouncements;(t&&t.querySelector(".panel-wrap")||window).removeEventListener("scroll",this.onScroll),(t&&t.querySelector(".panel-wrap")||window).removeEventListener("touchmove",this.onScroll),n()},n.prototype.render=function(){var e=this.props,t=e.announcements,n=e.paging,a=e.permissions,r=e.searchInputState,s=e.courseId,i=e.courseContext,l=e.localize,u=e.announcementsCounts,d=t&&Object.keys(t).length||0;return o.createElement("div",{className:"page-announcement course-announcement-layer"},o.createElement("div",{className:"panel-wrap"},o.createElement("header",{className:"panel-header simple-header"},o.createElement("div",{className:"panel-titles-container"},o.createElement("span",{className:"panel-sub-title"},i&&i.displayName||""),o.createElement("div",{className:"editable-title-container black-header-contents"},o.createElement(c.IconButton,{ariaLabel:l.translate("base.menu"),className:"left-off-canvas-toggle menu-toggle  standard-button dark-background",iconProps:{iconName:"main-menu"},title:l.translate("base.menu"),analyticsId:"course.announcements.listPanel.menu.button"}),o.createElement("h1",{className:"panel-title"},l.translate(h.resolveCourseOrgToken("announcements.pageTitle",i))))),o.createElement("div",{className:"header-actions-menu"},o.createElement("div",{className:"active no-select"},o.createElement(c.IconButton,{ariaLabel:l.translate("course.announcements.search.placeHolder"),className:"anchor-button",iconProps:{iconName:"search",iconSize:"medium"},id:"search-button",onClick:this.onToggleSearchInput,title:l.translate("course.announcements.search.placeHolder"),analyticsId:"course.announcements.listPanel.search.button"})))),o.createElement("div",{className:"guidance-wrapper "+(r.isCollapsed?"":"hide")},u&&n.count>=0&&o.createElement("span",null,a.viewUnposted?l.translate("course.announcements.guidance.instructor",{postedCount:u.postedCount||0,scheduledCount:u.scheduledCount||0})+l.translate("course.announcements.guidance.draftCount.plural",{draftCount:u.draftCount||0}):l.translate("course.announcements.guidance.student",{totalCount:n.count||0})),a.create&&o.createElement(c.IconButton,{ariaLabel:l.translate("course.announcements.createAnnouncement"),className:"create-announcement",iconProps:{iconName:"add-circle",iconSize:"medium"},onClick:this.onCreateAnnouncement,title:l.translate("course.announcements.createAnnouncement"),analyticsId:"course.announcements.listPanel.create.button"})),o.createElement("div",{className:"panel-content"},o.createElement("div",{className:"row collapse "+(r.isCollapsed?"hide":""),id:"announcement-search"},o.createElement(m.default,{courseId:s,debounceTime:1500,isCollapsed:r.isCollapsed,localize:l,minCharToStartSearching:S,notifyStateChange:this.searchInputStateChange,placeHolder:l.translate("course.announcements.search.placeHolder"),searchAnnouncements:this.loadAnnByCurrentSettings,searchText:r.searchText,analyticsId:"course.announcements.listPanel.search.input.text"})),o.createElement("div",{className:"row collapse"},this.renderAnnouncementListView(d),this.props.isLoading?o.createElement("div",{className:"spinner bb-secondary-color-2"}):""))))},n}(o.PureComponent);t.AnnouncementListPanel=g,t.default=s.connect(function(e){return{announcements:e.announcement.announcements,isLoading:e.announcement.isLoading,isSearchingSuccessful:e.announcement.isSearchingSuccessful,searchInputState:e.announcement.searchInputState,paging:e.announcement.paging,announcementsCounts:e.announcement.announcementsCounts,courseContext:e.announcement.courseContext,sortCriteria:e.announcement.sortCriteria,listener:e.announcement.listener,recentUpdatedAnnouncementIds:e.announcement.recentUpdatedAnnouncementIds}},function(e){return v.bindActionCreators({loadAnnouncements:f.actions.announcement.loadAnnouncements,removeAnnouncement:f.actions.announcement.removeAnnouncement,saveAnnouncement:f.actions.announcement.saveAnnouncement,changeSearchInputState:f.actions.announcement.changeSearchInputState,getAnnouncementsCounts:f.actions.announcement.getAnnouncementsCounts,getCourseContext:f.actions.announcement.getCourseContext,switchSortCriteria:f.actions.announcement.switchSortCriteria,clearAnnouncements:f.actions.announcement.clearAnnouncements,removeFromRecentUpdated:f.actions.announcement.removeFromRecentUpdated},e)})(l.localizedComponentWrapper(g))},yYIW:function(e,t,n){},zYff:function(e,t,n){}}]);